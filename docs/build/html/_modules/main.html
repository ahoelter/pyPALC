
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>main &#8212; pyPALC  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pyPALC  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">main</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for main</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">author: Arne Hoelter, Audio Communication Group, TU Berlin</span>

<span class="sd">The main script of the pyPALC application. This is a **Loudspeaker Array Optimization</span>
<span class="sd">Software** to find the tilt angles of the *Loudspeaker Cabinets*.</span>
<span class="sd">The application works with a bokeh server that can be called</span>
<span class="sd">by typing &quot;bokeh serve --show pyPALC&quot; in the terminal on the directory that</span>
<span class="sd">contains the &quot;pyPALC&quot; folder.</span>

<span class="sd">The script is structured as follows:</span>
<span class="sd">    1. Import all necessary modules</span>
<span class="sd">    2. Definition of objects for calculation and ColumnDataSources for visualization</span>
<span class="sd">    3. Definition of callbacks</span>
<span class="sd">    4. Definition of widgets</span>
<span class="sd">    5. Connection of widgets with callbacks</span>
<span class="sd">    6. Setting up all figures, tables and tabs</span>
<span class="sd">    7. Defining the start page (venue creation)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">######################## IMPORT PACKAGES ######################################</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">abs_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="n">appname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">abs_path</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">abs_path</span><span class="si">}</span><span class="s1">/fun/&#39;</span><span class="p">)</span> <span class="c1"># add functions to path</span>

<span class="c1"># import PALC functions</span>
<span class="kn">import</span> <span class="nn">calcPALC</span>
<span class="kn">import</span> <span class="nn">checkPAL</span>
<span class="kn">import</span> <span class="nn">PALC_classes</span>
<span class="kn">from</span> <span class="nn">PALC_functions</span> <span class="kn">import</span> <span class="n">calc_diff_tilt_angles</span><span class="p">,</span> <span class="n">LSA_visualization</span>
<span class="kn">from</span> <span class="nn">PALC_opt</span> <span class="kn">import</span> <span class="n">get_opt_region</span><span class="p">,</span> <span class="n">get_weight_links</span><span class="p">,</span> <span class="n">shift2ref</span><span class="p">,</span> <span class="n">shift_ref_on_zero</span>
<span class="kn">from</span> <span class="nn">sfp_functions</span> <span class="kn">import</span> <span class="n">calcSFP</span><span class="p">,</span> <span class="n">calcHomogeneity</span><span class="p">,</span> <span class="n">calc_directivity</span> 
<span class="kn">from</span> <span class="nn">sfp_functions</span> <span class="kn">import</span> <span class="n">init_dir_plot</span><span class="p">,</span> <span class="n">calcSPLoverX</span><span class="p">,</span> <span class="n">calcHistogram</span><span class="p">,</span> <span class="n">getBeamplotRes</span>
<span class="kn">from</span> <span class="nn">gui_help_text</span> <span class="kn">import</span> <span class="n">help_text</span>
<span class="kn">from</span> <span class="nn">gui_helper</span> <span class="kn">import</span> <span class="n">update_text</span><span class="p">,</span> <span class="n">venue_slice2CDS</span><span class="p">,</span> <span class="n">get_p_axis_rng</span>
<span class="kn">from</span> <span class="nn">gui_ls_array</span> <span class="kn">import</span> <span class="n">ref_array_angles</span><span class="p">,</span> <span class="n">read_dir_data</span><span class="p">,</span> <span class="n">arrange_ref_arr_in</span>
<span class="kn">from</span> <span class="nn">gui_algorithm_sfp</span> <span class="kn">import</span> <span class="n">optimize_PALC</span><span class="p">,</span> <span class="n">round_fixed_angle</span>
<span class="kn">from</span> <span class="nn">gui_algorithm_sfp</span> <span class="kn">import</span> <span class="n">get_fixed_angle_borders</span><span class="p">,</span> <span class="n">set_beamplot_visibility</span>
<span class="kn">from</span> <span class="nn">gui_algorithm_sfp</span> <span class="kn">import</span> <span class="n">update_gh_w_select</span><span class="p">,</span> <span class="n">set_weighting_in</span><span class="p">,</span> <span class="n">choose_gap_handling</span>
<span class="kn">from</span> <span class="nn">gui_venue</span> <span class="kn">import</span> <span class="n">check_all_draw_conditions</span>

<span class="c1"># Import python</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">colorcet</span> <span class="kn">import</span> <span class="n">rainbow</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Import bokeh</span>
<span class="kn">from</span> <span class="nn">bokeh.io</span> <span class="kn">import</span> <span class="n">curdoc</span>
<span class="kn">from</span> <span class="nn">bokeh.layouts</span> <span class="kn">import</span> <span class="n">column</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">gridplot</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">ColumnDataSource</span><span class="p">,</span> <span class="n">Range1d</span><span class="p">,</span> <span class="n">CustomJS</span><span class="p">,</span> <span class="n">ColorBar</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">LinearColorMapper</span><span class="p">,</span> <span class="n">FuncTickFormatter</span>
<span class="kn">from</span> <span class="nn">bokeh.models.widgets</span> <span class="kn">import</span> <span class="n">Slider</span><span class="p">,</span> <span class="n">TextInput</span><span class="p">,</span> <span class="n">Button</span><span class="p">,</span> <span class="n">Toggle</span><span class="p">,</span> <span class="n">FileInput</span>
<span class="kn">from</span> <span class="nn">bokeh.models.widgets</span> <span class="kn">import</span> <span class="n">RadioButtonGroup</span><span class="p">,</span> <span class="n">Select</span><span class="p">,</span> <span class="n">Paragraph</span><span class="p">,</span> <span class="n">DataTable</span>
<span class="kn">from</span> <span class="nn">bokeh.models.widgets</span> <span class="kn">import</span> <span class="n">TableColumn</span><span class="p">,</span> <span class="n">Div</span><span class="p">,</span> <span class="n">Panel</span><span class="p">,</span> <span class="n">Tabs</span><span class="p">,</span> <span class="n">TextAreaInput</span>
<span class="kn">from</span> <span class="nn">bokeh.models.widgets</span> <span class="kn">import</span> <span class="n">RadioGroup</span><span class="p">,</span> <span class="n">CheckboxGroup</span><span class="p">,</span> <span class="n">RangeSlider</span><span class="p">,</span> <span class="n">Paragraph</span>
<span class="kn">from</span> <span class="nn">bokeh.models.tools</span> <span class="kn">import</span> <span class="n">PointDrawTool</span>
<span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span>
<span class="kn">from</span> <span class="nn">bokeh.transform</span> <span class="kn">import</span> <span class="n">linear_cmap</span>
<span class="kn">from</span> <span class="nn">bokeh.palettes</span> <span class="kn">import</span> <span class="n">Cividis256</span>


<span class="c1">#%%########## Initialize all necessary objects ###############################</span>
<span class="n">created_pal</span>    <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">PAL</span><span class="p">(</span><span class="n">pal_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot;Audience lines drawn by user&quot;&quot;&quot;</span>
<span class="n">PALC_pal</span>       <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">PALC_compatible_PAL</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;PALC compatible venue slice (with audience lines)&quot;&quot;&quot;</span>
<span class="n">PALC_config</span>    <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">PALC_configuration</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;PALC configuration&quot;&quot;&quot;</span>
<span class="n">SFP_config</span>     <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">SFP_configuration</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Sound Field Prediction configuration (CDPS-Model)&quot;&quot;&quot;</span>
<span class="n">PALC_plots</span>     <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">PALC_plotting</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Plot data of PALC results&quot;&quot;&quot;</span>
<span class="n">PALC_plots_ref</span> <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">PALC_plotting</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Plot data of the reference array&quot;&quot;&quot;</span>
<span class="n">plt_ranges</span>     <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">Plot_ranges</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Ranges of the plots&quot;&quot;&quot;</span>
<span class="n">Opt_arr</span>        <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">Array_opt</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Data of the optimized array&quot;&quot;&quot;</span>
<span class="n">Ref_arr</span>        <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">Array_opt</span><span class="p">(</span><span class="n">gamma_tilt_deg</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot;Data of the reference array&quot;&quot;&quot;</span>
<span class="n">Tech_res</span>       <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">Technical_meas_results</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Results of the technical measures of the PALC optimized array&quot;&quot;&quot;</span>
<span class="n">Tech_res_ref</span>   <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">Technical_meas_results</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Results of the technical measures of the reference array&quot;&quot;&quot;</span>
<span class="n">Opt_w</span>          <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">Opt_weight</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Data needed for the target slope optimization of PALC (SPL over distance)&quot;&quot;&quot;</span>
<span class="n">SPLoverX</span>       <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">Opt_weight</span><span class="p">(</span><span class="n">SPL_interp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="sd">&quot;&quot;&quot;Result data of SPL over distance computation&quot;&quot;&quot;</span>
<span class="n">SPLoverX_ref</span>   <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">Opt_weight</span><span class="p">(</span><span class="n">SPL_interp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="sd">&quot;&quot;&quot;Result data of SPL over distance computation of reference LSA&quot;&quot;&quot;</span>
<span class="c1">############ Set up dictionaries for user interaction with the GUI ############</span>
<span class="n">x_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">chg_N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># Variables for Plotting</span>
<span class="n">guipal</span>     <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_init</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">x_init</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot;Contains data points that are given by user. Visualized in venue slice plot.&quot;&quot;&quot;</span>
<span class="n">guilineplt</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">xlineplt</span><span class="o">=</span><span class="p">[],</span> <span class="n">ylineplt</span><span class="o">=</span><span class="p">[]))</span>
<span class="sd">&quot;&quot;&quot;Contains the drawn audience lines based on user input. After compatibilization</span>
<span class="sd">   to the PALC algorithm, shows the lines used for PALC and SFP.&quot;&quot;&quot;</span>
<span class="n">guinalplt</span>  <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">xnalplt</span><span class="o">=</span><span class="p">[],</span> <span class="n">ynalplt</span><span class="o">=</span><span class="p">[]))</span>
<span class="sd">&quot;&quot;&quot;Contains non audience lines, e.g., gaps between audience line.&quot;&quot;&quot;</span>
<span class="n">guisfpplt</span>  <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">xsfpplt</span><span class="o">=</span><span class="p">[],</span> <span class="n">ysfpplt</span><span class="o">=</span><span class="p">[]))</span>
<span class="sd">&quot;&quot;&quot;Contains audience lines that are not used for PALC calcution but for SFP.&quot;&quot;&quot;</span>
<span class="n">plt_venue_slice_2</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">seg_pos_x</span><span class="o">=</span><span class="p">[],</span> <span class="n">seg_pos_y</span><span class="o">=</span><span class="p">[],</span> \
                                               <span class="n">seg_pos_start_x</span><span class="o">=</span><span class="p">[],</span> <span class="n">seg_pos_start_y</span><span class="o">=</span><span class="p">[],</span> \
                                               <span class="n">seg_pos_stop_x</span><span class="o">=</span><span class="p">[],</span> <span class="n">seg_pos_stop_y</span><span class="o">=</span><span class="p">[]))</span>
<span class="sd">&quot;&quot;&quot;Contains the rays from LSA cabinets to the venue slice in venue slice plot.&quot;&quot;&quot;</span>
<span class="n">plt_venue_slice_1</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x_start_stop</span><span class="o">=</span><span class="p">[],</span> <span class="n">y_start_stop</span><span class="o">=</span><span class="p">[],</span> \
                                               <span class="n">x_fin_unitn_start_stop</span><span class="o">=</span><span class="p">[],</span> \
                                               <span class="n">y_fin_unitn_start_stop</span><span class="o">=</span><span class="p">[],</span> \
                                               <span class="n">x_start_unitn_start</span><span class="o">=</span><span class="p">[],</span> \
                                               <span class="n">y_start_unitn_start</span><span class="o">=</span><span class="p">[],</span> \
                                               <span class="n">x_stop_unitn_stop</span><span class="o">=</span><span class="p">[],</span> \
                                               <span class="n">y_stop_unitn_stop</span><span class="o">=</span><span class="p">[],</span> \
                                               <span class="n">x_c_n_unitn</span><span class="o">=</span><span class="p">[],</span> <span class="n">y_c_n_unitn</span><span class="o">=</span><span class="p">[],</span> \
                                               <span class="n">x_c_n_unitn_psi1</span><span class="o">=</span><span class="p">[],</span> \
                                               <span class="n">y_c_n_unitn_psi1</span><span class="o">=</span><span class="p">[],</span> \
                                               <span class="n">x_c_n_unitn_psi2</span><span class="o">=</span><span class="p">[],</span> \
                                               <span class="n">y_c_n_unitn_psi2</span><span class="o">=</span><span class="p">[]))</span>
<span class="sd">&quot;&quot;&quot;Contains data to plot the LSA cabinets in venue slice plot.&quot;&quot;&quot;</span>
<span class="n">results_dict</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">a_num_LS</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">PALC_config</span><span class="o">.</span><span class="n">N</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> \
                                          <span class="n">b_gamma_tilt_deg</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> \
                                          <span class="n">c_gamma_tilt_deg_diff</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])))</span>
<span class="sd">&quot;&quot;&quot;Contains the tilt angles of the LSA cabinet computed by PALC.&quot;&quot;&quot;</span>
<span class="n">gamma_ref_dict</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">gamma_ref</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">PALC_config</span><span class="o">.</span><span class="n">N</span><span class="p">)]),</span> \
                                            <span class="n">LS</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">PALC_config</span><span class="o">.</span><span class="n">N</span><span class="p">)])))</span>
<span class="sd">&quot;&quot;&quot;Contains the tilt angles of the reference LSA.&quot;&quot;&quot;</span>
<span class="c1"># Set up dicts for plotting</span>
<span class="n">p_SPL</span>    <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">x_vert</span>   <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">SFP_dict</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">p_SPL</span><span class="o">=</span><span class="n">p_SPL</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">p_SPL</span><span class="p">,</span> \
                                      <span class="n">foo</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p_SPL</span><span class="p">)[</span><span class="mi">0</span><span class="p">])),</span> \
                                      <span class="n">p_SPL_ref</span><span class="o">=</span><span class="n">p_SPL</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot;Contains the sound pressure levels of PALC and reference computed by the CDPS model.&quot;&quot;&quot;</span>
<span class="n">SFPv_dict</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x_vert</span><span class="o">=</span><span class="n">x_vert</span><span class="p">,</span> <span class="n">y_vert</span><span class="o">=</span><span class="n">x_vert</span><span class="p">,</span> \
                                       <span class="n">foo</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">x_vert</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))))</span>
<span class="sd">&quot;&quot;&quot;Contains the discrete venue slice points needed for visualization of :any:`SFP_dict`.&quot;&quot;&quot;</span>    
<span class="n">Homogeneity_dict</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">H</span><span class="o">=</span><span class="n">x_vert</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">x_vert</span><span class="p">,</span> \
                                              <span class="n">H_dist_high</span><span class="o">=</span><span class="n">x_vert</span><span class="p">,</span> \
                                              <span class="n">H_dist_low</span><span class="o">=</span><span class="n">x_vert</span><span class="p">,</span> \
                                              <span class="n">H_str</span><span class="o">=</span><span class="n">x_vert</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot;Contains the computed homogeneity.&quot;&quot;&quot;</span>
<span class="n">Bar_dict</span>     <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">x_vert</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x_vert</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot;Contains the values of the bar plot of the PALC results.&quot;&quot;&quot;</span>
<span class="n">Bar_dict_ref</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">top_ref</span><span class="o">=</span><span class="n">x_vert</span><span class="p">,</span> <span class="n">x_ref</span><span class="o">=</span><span class="n">x_vert</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot;Contains the values of the bar plot of the reference results.&quot;&quot;&quot;</span>
<span class="n">directivity_dict_plt</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">amplitude_100</span><span class="o">=</span><span class="n">p_SPL</span><span class="p">,</span> \
                                                  <span class="n">amplitude_1k</span><span class="o">=</span><span class="n">p_SPL</span><span class="p">,</span> \
                                                  <span class="n">amplitude_10k</span><span class="o">=</span><span class="n">p_SPL</span><span class="p">,</span> \
                                                  <span class="n">degree</span><span class="o">=</span><span class="n">p_SPL</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot;Contains the directivity of 100 Hz, 1 kHz and 10 kHz used in SFP (CDPS-model).</span>
<span class="sd">   Plotted on the second page.&quot;&quot;&quot;</span>
<span class="n">SPLoverX_dict</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="n">p_SPL</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x_vert</span><span class="p">,</span> <span class="n">x_v</span><span class="o">=</span><span class="n">x_vert</span><span class="p">,</span> \
                                           <span class="n">y_v</span><span class="o">=</span><span class="n">x_vert</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot;Contains the SPL values over distance between LSA reference point and the</span>
<span class="sd">   receiver positions normalized on 0 dB (if target slope, optimization region is used).&quot;&quot;&quot;</span>
<span class="n">SPLoverX_ref_dict</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="n">p_SPL</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x_vert</span><span class="p">,</span> <span class="n">x_v</span><span class="o">=</span><span class="n">x_vert</span><span class="p">,</span> \
                                           <span class="n">y_v</span><span class="o">=</span><span class="n">x_vert</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot;Contains the SPL values over distance between LSA reference point and the</span>
<span class="sd">   receiver positions normalized on 0 dB of reference LSA.&quot;&quot;&quot;</span>    
<span class="n">Opt_SPLoverX_dict</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="n">p_SPL</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x_vert</span><span class="p">,</span> <span class="n">x_v</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> \
                                               <span class="n">y_v</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">Opt_refpoint_dict</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x_ref</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span><span class="n">SPL</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x_v</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y_v</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="sd">&quot;&quot;&quot;Contains SPL and distance values on the hinges of the target slope.&quot;&quot;&quot;</span>
<span class="n">SPLoverX_optreg</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="sd">&quot;&quot;&quot;Contains edges of the drawn polygon which indicates the optimization region&quot;&quot;&quot;</span>
<span class="n">Beamplot_dict</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">])],</span> \
                                           <span class="n">SPL_ref</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">])],</span> \
                                           <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">dw</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">dh</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
<span class="sd">&quot;&quot;&quot;Contains the SPL, start points, height and widtch of the beamplot (PALC and reference).&quot;&quot;&quot;</span>
<span class="n">plot_patches</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x_list</span><span class="o">=</span><span class="p">[],</span> <span class="n">y_list</span><span class="o">=</span><span class="p">[],</span> \
                                          <span class="n">x_list_ref</span><span class="o">=</span><span class="p">[],</span> <span class="n">y_list_ref</span><span class="o">=</span><span class="p">[]))</span>
<span class="sd">&quot;&quot;&quot;Contains the values to plot the LSA cabinets with bokeh&#39;s patch function.&quot;&quot;&quot;</span>
<span class="c1"># dict to store tapped audience line to insert previous line or delete selected line</span>
<span class="n">audience_line_tap_dict</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">tapped</span><span class="o">=</span><span class="p">[]))</span>
<span class="sd">&quot;&quot;&quot;Contains the tapped line of the venue slice plot.&quot;&quot;&quot;</span>

<span class="c1"># initialize the directivity plot</span>
<span class="n">c0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta_deg</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">dir_meas</span><span class="p">,</span> <span class="n">dir_meas_deg</span><span class="p">,</span> <span class="n">H_post</span> <span class="o">=</span> <span class="n">init_dir_plot</span><span class="p">()</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">H_post</span><span class="p">[:,</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">calc_directivity</span><span class="p">(</span><span class="n">PALC_config</span><span class="o">.</span><span class="n">directivity</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> \
                                   <span class="n">PALC_config</span><span class="o">.</span><span class="n">Lambda_y</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">omega</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">c0</span><span class="p">,</span> \
                                   <span class="n">f</span><span class="p">,</span> <span class="n">dir_meas</span><span class="p">[:,</span><span class="n">n</span><span class="p">],</span> <span class="n">dir_meas_deg</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">n</span><span class="p">)</span>
<span class="nb">setattr</span><span class="p">(</span><span class="n">SFP_config</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="n">SFP_config</span><span class="o">.</span><span class="n">get_plot_dir_amp</span><span class="p">(</span><span class="n">H_post</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">])</span>    
<span class="c1"># write data in ColumnDataSource that is for directivity plotting</span>
<span class="n">directivity_dict_plt</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">amplitude_100</span><span class="o">=</span><span class="n">SFP_config</span><span class="o">.</span><span class="n">plot_dir_amp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> \
                                 <span class="n">amplitude_1k</span><span class="o">=</span><span class="n">SFP_config</span><span class="o">.</span><span class="n">plot_dir_amp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> \
                                 <span class="n">amplitude_10k</span><span class="o">=</span><span class="n">SFP_config</span><span class="o">.</span><span class="n">plot_dir_amp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> \
                                 <span class="n">degree</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">beta_deg</span><span class="p">))</span>   

<span class="c1">#%%########## CALLBACKS SPECIFICALLY USED IN PAGE 1. PAL ######################    </span>

<div class="viewcode-block" id="update_point"><a class="viewcode-back" href="../main.html#main.update_point">[docs]</a><span class="k">def</span> <span class="nf">update_point</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that saves the input data to draw audience lines.</span>
<span class="sd">    Reads the input of the start and end points and stores them in :any:`guipal`.</span>
<span class="sd">    After storing, updates the range of the Venue Slice Plot. Triggered by</span>
<span class="sd">    :any:`start_point_x`, :any:`start_point_y`, :any:`end_point_x` and</span>
<span class="sd">    :any:`end_point_y`.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attr : str</span>
<span class="sd">        Value attribute returned from widget.</span>
<span class="sd">    old : float</span>
<span class="sd">        Old value of changed attribute.</span>
<span class="sd">    new : float</span>
<span class="sd">        New value of changed attribute.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># transform points into floats</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">start_point_x</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">end_point_x</span><span class="o">.</span><span class="n">value</span><span class="p">)])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">start_point_y</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">end_point_y</span><span class="o">.</span><span class="n">value</span><span class="p">)])</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">pal_error_info</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">pal_error_info</span><span class="p">,</span> <span class="s1">&#39;Error: Wrong Input. Only Numbers are allowed&#39;</span><span class="p">)</span>
        <span class="k">return</span>    
    <span class="c1"># write the values in the dictionary</span>
    <span class="n">guipal</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="save_line"><a class="viewcode-back" href="../main.html#main.save_line">[docs]</a><span class="k">def</span> <span class="nf">save_line</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to draw audience lines based on the data stored in :any:`guipal`.</span>
<span class="sd">    Triggered by :any:`save_line_button`</span>
<span class="sd">    Checks the defined conditions defined in :py:mod:`checkPAL`. These are:</span>
<span class="sd">        </span>
<span class="sd">        1. Stop values are bigger or equal to the start values</span>
<span class="sd">        2. The slope of the lines must be zero or positive</span>
<span class="sd">        3. No point of intersection shall be in the range of a line</span>
<span class="sd">        </span>
<span class="sd">    Stores the drawn lines in :any:`guilineplt`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="c1"># load the necessary data input</span>
    <span class="p">[</span><span class="n">x_start</span><span class="p">,</span> <span class="n">x_stop</span><span class="p">]</span> <span class="o">=</span> <span class="n">guipal</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="n">y_start</span><span class="p">,</span> <span class="n">y_stop</span><span class="p">]</span> <span class="o">=</span> <span class="n">guipal</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>

    <span class="c1"># distance between start and end point of audience line</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x_stop</span> <span class="o">-</span> <span class="n">x_start</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y_stop</span> <span class="o">-</span> <span class="n">y_start</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1">################# check conditions for adding a audience line ############################</span>
    <span class="n">condition1</span><span class="p">,</span> <span class="n">condition2</span><span class="p">,</span> <span class="n">condition3</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> \
        <span class="n">check_all_draw_conditions</span><span class="p">(</span><span class="n">x_start</span><span class="p">,</span> <span class="n">x_stop</span><span class="p">,</span> <span class="n">y_start</span><span class="p">,</span> <span class="n">y_stop</span><span class="p">,</span> \
                                  <span class="n">created_pal</span><span class="p">,</span> <span class="n">pal_error_info</span><span class="p">)</span>        
    <span class="c1"># Check if all conditions are fullfilled, add the line, save the line in the dictionary and set up the plot range again</span>
    <span class="k">if</span> <span class="n">condition1</span> <span class="ow">and</span> <span class="n">condition2</span> <span class="ow">and</span> <span class="n">condition3</span><span class="p">:</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">pal_error_info</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">l_d</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line_discretization</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">l_d</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">update_text</span><span class="p">(</span><span class="n">pal_error_info</span><span class="p">,</span><span class="s1">&#39;Couldnt process discretization input. Use default: 5 points per m&#39;</span><span class="p">)</span>
        <span class="c1"># Create the new audience line</span>
        <span class="n">created_pal</span><span class="o">.</span><span class="n">append_line</span><span class="p">(</span><span class="n">x_start</span><span class="p">,</span> <span class="n">x_stop</span><span class="p">,</span> <span class="n">y_start</span><span class="p">,</span> <span class="n">y_stop</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">diff</span><span class="o">*</span><span class="n">l_d</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">:</span>
            <span class="n">remove_line</span><span class="p">()</span>
            <span class="n">update_text</span><span class="p">(</span><span class="n">pal_error_info</span><span class="p">,</span><span class="s1">&#39;Couldnt append line. Maximum discretized points are 2000. Please reduce the discretization.&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="c1"># set ranges</span>
        <span class="n">x_range</span> <span class="o">=</span> <span class="n">plt_ranges</span><span class="o">.</span><span class="n">update_range</span><span class="p">(</span><span class="s1">&#39;p_x&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">created_pal</span><span class="o">.</span><span class="n">xline_start</span><span class="p">,</span> \
                                          <span class="n">created_pal</span><span class="o">.</span><span class="n">xline_stop</span><span class="p">,</span> <span class="n">PALC_config</span><span class="o">.</span><span class="n">x_H</span><span class="p">)</span>
        <span class="n">y_range</span> <span class="o">=</span> <span class="n">plt_ranges</span><span class="o">.</span><span class="n">update_range</span><span class="p">(</span><span class="s1">&#39;p_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">created_pal</span><span class="o">.</span><span class="n">yline_start</span><span class="p">,</span> \
                                          <span class="n">created_pal</span><span class="o">.</span><span class="n">yline_stop</span><span class="p">,</span> <span class="n">PALC_config</span><span class="o">.</span><span class="n">y_H</span><span class="p">)</span>
        <span class="c1"># write ranges to plots</span>
        <span class="n">scale_p_axis</span><span class="p">(</span><span class="n">call</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">set_ranges</span><span class="p">(</span><span class="n">figs</span><span class="o">=</span><span class="p">[</span><span class="n">pBeam</span><span class="p">,</span> <span class="n">pBeam_ref</span><span class="p">,</span> <span class="n">pSFPv</span><span class="p">],</span> <span class="n">sizes</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> \
                   <span class="n">ranges</span><span class="o">=</span><span class="p">[</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">])</span>
        <span class="n">pSPLoverX</span><span class="o">.</span><span class="n">x_range</span> <span class="o">=</span> <span class="n">x_range</span>        
        <span class="c1"># save data into the dictionries</span>
        <span class="n">guilineplt</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xlineplt</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">plot_x</span><span class="p">,</span> <span class="n">ylineplt</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">plot_y</span><span class="p">)</span>
        <span class="n">change_start_pal_button</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">steps</span><span class="p">()</span></div>


<div class="viewcode-block" id="remove_line"><a class="viewcode-back" href="../main.html#main.remove_line">[docs]</a><span class="k">def</span> <span class="nf">remove_line</span><span class="p">():</span> 
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes the last created line.</span>
<span class="sd">    Triggered by :any:`remove_line_button`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># remove the last created line</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">created_pal</span><span class="o">.</span><span class="n">pal_index</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">created_pal</span><span class="o">.</span><span class="n">remove_last_line</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">created_pal</span><span class="o">.</span><span class="n">pal_index</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># set ranges</span>
        <span class="n">x_range</span> <span class="o">=</span> <span class="n">plt_ranges</span><span class="o">.</span><span class="n">update_range</span><span class="p">(</span><span class="s1">&#39;p_x&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">created_pal</span><span class="o">.</span><span class="n">xline_start</span><span class="p">,</span> \
                                          <span class="n">created_pal</span><span class="o">.</span><span class="n">xline_stop</span><span class="p">,</span> <span class="n">PALC_config</span><span class="o">.</span><span class="n">x_H</span><span class="p">)</span>
        <span class="n">y_range</span> <span class="o">=</span> <span class="n">plt_ranges</span><span class="o">.</span><span class="n">update_range</span><span class="p">(</span><span class="s1">&#39;p_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">created_pal</span><span class="o">.</span><span class="n">yline_start</span><span class="p">,</span> \
                                          <span class="n">created_pal</span><span class="o">.</span><span class="n">yline_stop</span><span class="p">,</span> <span class="n">PALC_config</span><span class="o">.</span><span class="n">y_H</span><span class="p">)</span>
        <span class="c1"># write ranges to plots</span>
        <span class="n">scale_p_axis</span><span class="p">(</span><span class="n">call</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">set_ranges</span><span class="p">(</span><span class="n">figs</span><span class="o">=</span><span class="p">[</span><span class="n">pBeam</span><span class="p">,</span> <span class="n">pBeam_ref</span><span class="p">,</span> <span class="n">pSFPv</span><span class="p">],</span> <span class="n">sizes</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> \
                   <span class="n">ranges</span><span class="o">=</span><span class="p">[</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">])</span>
        <span class="n">pSPLoverX</span><span class="o">.</span><span class="n">x_range</span> <span class="o">=</span> <span class="n">x_range</span>
          
    <span class="c1"># write the output into the dictionaries</span>
    <span class="n">guilineplt</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xlineplt</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">plot_x</span><span class="p">,</span> <span class="n">ylineplt</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">plot_y</span><span class="p">)</span>
    <span class="n">change_start_pal_button</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="create_prev_line"><a class="viewcode-back" href="../main.html#main.create_prev_line">[docs]</a><span class="k">def</span> <span class="nf">create_prev_line</span><span class="p">():</span>  
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a line in front of the selected line (only possible if a line is</span>
<span class="sd">    selected). Gets the tapped line from :any:`audience_line_tap_dict`, checks</span>
<span class="sd">    the draw conditions and inserts the line with ... Stores the data in</span>
<span class="sd">    :any:`guilineplt`.</span>
<span class="sd">    Triggered by :any:`save_prev_line_button`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="c1"># load the necessary data out of the dictionaries</span>
    <span class="c1"># distance between start and end point of audience line</span>
    <span class="p">[</span><span class="n">x_start</span><span class="p">,</span> <span class="n">x_stop</span><span class="p">]</span> <span class="o">=</span> <span class="n">guipal</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="n">y_start</span><span class="p">,</span> <span class="n">y_stop</span><span class="p">]</span> <span class="o">=</span> <span class="n">guipal</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
    <span class="n">sel_ind</span> <span class="o">=</span> <span class="n">audience_line_tap_dict</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;tapped&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># get the discretization of the line</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x_stop</span> <span class="o">-</span> <span class="n">x_start</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y_stop</span> <span class="o">-</span> <span class="n">y_start</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">l_d</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line_discretization</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">l_d</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">pal_error_info</span><span class="p">,</span> <span class="s1">&#39;Couldnt process discretization input. Use default: 5 points per m&#39;</span><span class="p">)</span>
    <span class="c1"># check if draw conditions are fulfilled</span>
    <span class="n">condition1</span><span class="p">,</span> <span class="n">condition2</span><span class="p">,</span> <span class="n">condition3</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> \
        <span class="n">check_all_draw_conditions</span><span class="p">(</span><span class="n">x_start</span><span class="p">,</span> <span class="n">x_stop</span><span class="p">,</span> <span class="n">y_start</span><span class="p">,</span> <span class="n">y_stop</span><span class="p">,</span> \
                                  <span class="n">created_pal</span><span class="p">,</span> <span class="n">pal_error_info</span><span class="p">)</span>
    <span class="c1"># Check if all conditions are fullfilled, add the line, save the line in the dictionary and set up the plot range again</span>
    <span class="k">if</span> <span class="n">condition1</span> <span class="ow">and</span> <span class="n">condition2</span> <span class="ow">and</span> <span class="n">condition3</span><span class="p">:</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">pal_error_info</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>  
        <span class="c1"># Insert new audience line      </span>
        <span class="n">created_pal</span><span class="o">.</span><span class="n">insert_previous_line</span><span class="p">(</span><span class="n">sel_ind</span><span class="p">,</span> <span class="n">x_start</span><span class="p">,</span> <span class="n">x_stop</span><span class="p">,</span> <span class="n">y_start</span><span class="p">,</span> \
                                         <span class="n">y_stop</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">diff</span><span class="o">*</span><span class="n">l_d</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">:</span>
            <span class="n">remove_sel_line</span><span class="p">()</span>
            <span class="n">update_text</span><span class="p">(</span><span class="n">pal_error_info</span><span class="p">,</span><span class="s1">&#39;Couldnt append line. Maximum discretized points are 2000. Please reduce the discretization.&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="c1"># write the output into the dictionaries</span>
        <span class="n">guilineplt</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xlineplt</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">plot_x</span><span class="p">,</span> <span class="n">ylineplt</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">plot_y</span><span class="p">)</span>
        <span class="n">change_start_pal_button</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">steps</span><span class="p">()</span></div>
    

<div class="viewcode-block" id="remove_sel_line"><a class="viewcode-back" href="../main.html#main.remove_sel_line">[docs]</a><span class="k">def</span> <span class="nf">remove_sel_line</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes the selected line. Tapped line is stored in :any:`audience_line_tap_dict`.</span>
<span class="sd">    The index of the lines behind the removed line are then shifted by -1.</span>
<span class="sd">    Triggered by :any:`remove_sel_line_button`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># load the necessary data out of the dictionaries</span>
    <span class="n">sel_ind</span> <span class="o">=</span> <span class="n">audience_line_tap_dict</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;tapped&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>    
    <span class="c1"># remove selected line</span>
    <span class="n">created_pal</span><span class="o">.</span><span class="n">remove_selected_line</span><span class="p">(</span><span class="n">sel_ind</span><span class="p">)</span>       
    <span class="c1"># write the output into the dictionaries and change buttons</span>
    <span class="n">guilineplt</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xlineplt</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">plot_x</span><span class="p">,</span> <span class="n">ylineplt</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">plot_y</span><span class="p">)</span>
    <span class="n">change_start_pal_button</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">steps</span><span class="p">()</span></div>


<div class="viewcode-block" id="audience_line_tap"><a class="viewcode-back" href="../main.html#main.audience_line_tap">[docs]</a><span class="k">def</span> <span class="nf">audience_line_tap</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls the visibility of line saving and removing buttons / widgets depending</span>
<span class="sd">    on user selection of audience lines. Updates :any:`audience_line_tap_dict`</span>
<span class="sd">    if a line is selected (or not).</span>
<span class="sd">    Triggered if user taps on a line in figure :any:`p`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attr : str</span>
<span class="sd">        Attribute name (here index).</span>
<span class="sd">    old : int</span>
<span class="sd">        Index of previously tapped line. [] if no line is tapped.</span>
<span class="sd">    new : int</span>
<span class="sd">        Index of actually tapped line. [] if no line is tapped..</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">new</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="n">save_prev_line_button</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">remove_sel_line_button</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">save_line_button</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">remove_line_button</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">save_prev_line_button</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">remove_sel_line_button</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">save_line_button</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">remove_line_button</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">audience_line_tap_dict</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">tapped</span><span class="o">=</span><span class="n">new</span><span class="p">)</span></div>

   
<div class="viewcode-block" id="check_PAL"><a class="viewcode-back" href="../main.html#main.check_PAL">[docs]</a><span class="k">def</span> <span class="nf">check_PAL</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a PALC compatible venue slice suggestions based on the lines drawn</span>
<span class="sd">    by the user. Updates :any:`guinalplt` and :any:`guisfpplt`. Calls checkPAL</span>
<span class="sd">    functions and PALC_pal methods to create the venue. :any:`PALC_pal` may then</span>
<span class="sd">    be used for PALC computation. Resets initialization of :any:`Opt_w`.</span>
<span class="sd">    Triggered by :any:`check_PAL_button`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># initialize objects</span>
        <span class="n">suggested_nal</span> <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">PAL</span><span class="p">(</span><span class="n">ind_iscut</span><span class="o">=</span><span class="p">[])</span>
        <span class="n">suggested_sfp</span> <span class="o">=</span> <span class="n">PALC_classes</span><span class="o">.</span><span class="n">PAL</span><span class="p">(</span><span class="n">ind_iscut</span><span class="o">=</span><span class="p">[])</span>
        <span class="c1"># compute checking</span>
        <span class="n">checkPAL</span><span class="o">.</span><span class="n">suggestPAL</span><span class="p">(</span><span class="n">created_pal</span><span class="p">,</span> <span class="n">suggested_nal</span><span class="p">,</span> <span class="n">suggested_sfp</span><span class="p">)</span>
        <span class="c1"># plot the suggested lines</span>
        <span class="n">guinalplt</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xnalplt</span><span class="o">=</span><span class="n">suggested_nal</span><span class="o">.</span><span class="n">plot_x</span><span class="p">,</span> <span class="n">ynalplt</span><span class="o">=</span><span class="n">suggested_nal</span><span class="o">.</span><span class="n">plot_y</span><span class="p">)</span>
        <span class="n">guisfpplt</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xsfpplt</span><span class="o">=</span><span class="n">suggested_sfp</span><span class="o">.</span><span class="n">plot_x</span><span class="p">,</span> <span class="n">ysfpplt</span><span class="o">=</span><span class="n">suggested_sfp</span><span class="o">.</span><span class="n">plot_y</span><span class="p">)</span>
        <span class="c1"># initialize PALC compatible pal lines and create them</span>
        <span class="n">PALC_pal</span><span class="o">.</span><span class="n">pal</span><span class="p">,</span> <span class="n">PALC_pal</span><span class="o">.</span><span class="n">pal_no_nal</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">checkPAL</span><span class="o">.</span><span class="n">get_PALC_compatible_PAL</span><span class="p">(</span><span class="n">PALC_pal</span><span class="p">,</span> <span class="n">created_pal</span><span class="p">,</span> <span class="n">suggested_nal</span><span class="p">,</span> <span class="n">suggested_sfp</span><span class="p">)</span>
        <span class="n">PALC_pal</span><span class="o">.</span><span class="n">create_pal_without_nal</span><span class="p">(</span><span class="n">suggested_nal</span><span class="p">)</span>
        <span class="n">change_start_pal_button</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">steps</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">gui_weighting</span><span class="o">.</span><span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Target Slope&#39;</span><span class="p">]:</span>
            <span class="n">gui_weighting</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;Without&#39;</span>
            <span class="n">Opt_w</span><span class="o">.</span><span class="n">init</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">weighting_select</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="c1">#np.shape(created_pal.xline)[0]</span>
        <span class="n">weight_links</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">created_pal</span><span class="o">.</span><span class="n">xline_start</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">gui_opt_weight_link</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">weight_links</span><span class="p">)]</span>
        <span class="n">gui_opt_weight_link</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;Error: Could not create PAL proposal&#39;</span><span class="p">)</span></div>
          

<div class="viewcode-block" id="change_start_pal_button"><a class="viewcode-back" href="../main.html#main.change_start_pal_button">[docs]</a><span class="k">def</span> <span class="nf">change_start_pal_button</span><span class="p">(</span><span class="n">has_pal</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If :any:`check_PAL` terminated succesfully, the &quot;Run Calcution&quot; Button is</span>
<span class="sd">    enabled.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    has_pal : bool</span>
<span class="sd">        If True: PALC computation is enabled, otherwise disabled.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">has_pal</span> <span class="ow">and</span> <span class="n">PALC_pal</span><span class="o">.</span><span class="n">pal</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="n">gui_start</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">check_PAL_button</span><span class="o">.</span><span class="n">button_type</span> <span class="o">=</span> <span class="s2">&quot;success&quot;</span>
        <span class="n">check_PAL_button</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;8. Venue is PALC compatible!&quot;</span>
        <span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">gui_use_fixed_angles</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gui_start</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">check_PAL_button</span><span class="o">.</span><span class="n">button_type</span> <span class="o">=</span> <span class="s2">&quot;warning&quot;</span>
        <span class="n">check_PAL_button</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;8. Get PALC Venue Proposal&quot;</span>
        <span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">gui_use_fixed_angles</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">gui_use_fixed_angles</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;No&#39;</span>
        <span class="n">gui_fixed_first_angle</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">PALC_config</span><span class="o">.</span><span class="n">use_fixed_angle</span> <span class="o">=</span> <span class="kc">False</span></div>

<span class="c1">#%%### CALLBACKS SPECIFICALLY USED IN PAGE 2. LOUDSPEAKER CONFIGURATION #######    </span>

<div class="viewcode-block" id="upload_directivity"><a class="viewcode-back" href="../main.html#main.upload_directivity">[docs]</a><span class="k">def</span> <span class="nf">upload_directivity</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads the directivity and stores the directivity of the plotted frequencies</span>
<span class="sd">    in :any:`directivity_dict_plt`.</span>
<span class="sd">    Uploaded csv-data must be formatted as: frequency bins in lines and angle</span>
<span class="sd">    in degree in rows. Imaginary unit can be &quot;j&quot; or &quot;i&quot;.</span>
<span class="sd">    Triggered if :any:`button_input` receives a .csv-file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attr : str</span>
<span class="sd">        Changed attribute.</span>
<span class="sd">    old : str</span>
<span class="sd">        Old input.</span>
<span class="sd">    new : str</span>
<span class="sd">        New input. csv-data to read.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">read_dir_data</span><span class="p">(</span><span class="n">SFP_config</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
        <span class="n">directivity_dict_plt</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">amplitude_100</span><span class="o">=</span><span class="n">SFP_config</span><span class="o">.</span><span class="n">plot_dir_amp_meas</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> \
                                         <span class="n">amplitude_1k</span><span class="o">=</span><span class="n">SFP_config</span><span class="o">.</span><span class="n">plot_dir_amp_meas</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> \
                                         <span class="n">amplitude_10k</span><span class="o">=</span><span class="n">SFP_config</span><span class="o">.</span><span class="n">plot_dir_amp_meas</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> \
                                         <span class="n">degree</span><span class="o">=</span><span class="n">SFP_config</span><span class="o">.</span><span class="n">plot_beta_meas</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;Error: Could not read Measured Loudspeaker Data&#39;</span><span class="p">)</span></div>
        
<span class="c1">#%%#### CALLBACKS SPECIFICALLY USED IN PAGE 3. ARRAY CONFIGURATION ############</span>

<span class="c1">## Callback to disable and enable field of discrete tilt angles and </span>
<span class="c1"># shows a default example</span>
<div class="viewcode-block" id="choose_dangles"><a class="viewcode-back" href="../main.html#main.choose_dangles">[docs]</a><span class="k">def</span> <span class="nf">choose_dangles</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If discrete angles are used, text input field to insert a set of discrete</span>
<span class="sd">    tilt angles is enabled (and filled with a default set).</span>
<span class="sd">    Triggered by :any:`gui_use_dangles`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attr : str</span>
<span class="sd">        Changed attribute (value can be &#39;Yes&#39; or &#39;No&#39;).</span>
<span class="sd">    old : str</span>
<span class="sd">        Old value of the widget gui_use_dangles.</span>
<span class="sd">    new : TYPE</span>
<span class="sd">        New value of the widget gui_use_dangles.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">gui_use_dangles</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
        <span class="n">gui_discrete_angles</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;0,0.5,1,2,3.5,5,7,10&#39;</span>
        <span class="n">gui_discrete_angles</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">PALC_config</span><span class="o">.</span><span class="n">store_config</span><span class="p">(</span><span class="s1">&#39;use_gamma_LSA&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">gui_ref_discrete_angles</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">elif</span> <span class="n">gui_use_dangles</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;No&#39;</span><span class="p">:</span>
        <span class="n">gui_discrete_angles</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">gui_discrete_angles</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">PALC_config</span><span class="o">.</span><span class="n">store_config</span><span class="p">(</span><span class="s1">&#39;use_gamma_LSA&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">gui_ref_discrete_angles</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">gui_ref_discrete_angles</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;No&quot;</span>
    <span class="n">get_discrete_angles</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_discrete_angles"><a class="viewcode-back" href="../main.html#main.get_discrete_angles">[docs]</a><span class="k">def</span> <span class="nf">get_discrete_angles</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads a set of discrete tilt angles. Enabled if :any:`gui_use_dangles`</span>
<span class="sd">    is set to &#39;Yes&#39;. Triggered by :any:`gui_discrete_angles`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attr : str</span>
<span class="sd">        Changed attribute.</span>
<span class="sd">    old : str</span>
<span class="sd">        Old set of discrete tilt angles.</span>
<span class="sd">    new : str</span>
<span class="sd">        New set of discrete tilt angles with &#39;,&#39; as seperator and &#39;.&#39; as decimal</span>
<span class="sd">        seperator.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># check if function was called because discrete angles were disabled</span>
    <span class="k">if</span> <span class="n">PALC_config</span><span class="o">.</span><span class="n">use_gamma_LSA</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">PALC_config</span><span class="o">.</span><span class="n">gamma_LSA</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span>  
    <span class="c1"># convert input and store in PALC_config object</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">PALC_config</span><span class="o">.</span><span class="n">gamma_LSA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">gui_discrete_angles</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
<span class="c1">#        discrete_angles_dict.data = dict(discrete_angles=PALC_config.gamma_LSA)</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;Error: Could not process the input&#39;</span><span class="p">)</span></div>

      
<div class="viewcode-block" id="reference_array_setting"><a class="viewcode-back" href="../main.html#main.reference_array_setting">[docs]</a><span class="k">def</span> <span class="nf">reference_array_setting</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Saves the current setting of the reference LSA. Set widgets visible / invisible</span>
<span class="sd">    or enables / disables them if needed / not needed. Triggered by</span>
<span class="sd">    :any:`gui_ref_array`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attr : str</span>
<span class="sd">        Changed attribute (value).</span>
<span class="sd">    old : str</span>
<span class="sd">        Old reference array setting.</span>
<span class="sd">    new : str</span>
<span class="sd">        New reference array setting.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">arrange_ref_arr_in</span><span class="p">(</span><span class="n">gui_ref_array</span><span class="p">,</span> <span class="n">gui_ref_start</span><span class="p">,</span> <span class="n">gui_ref_step_stop</span><span class="p">,</span> \
                       <span class="n">gui_ref_discrete_angles</span><span class="p">,</span> <span class="n">gui_ref_userdef</span><span class="p">)</span>
    <span class="n">get_ref_array_angles</span><span class="p">()</span></div>

     
<div class="viewcode-block" id="get_ref_array_angles"><a class="viewcode-back" href="../main.html#main.get_ref_array_angles">[docs]</a><span class="k">def</span> <span class="nf">get_ref_array_angles</span><span class="p">(</span><span class="n">chg_n</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Saves and calculates the reference array tilt angles. Is triggered by</span>
<span class="sd">    :any:`reference_array_setting`, :any:`gui_ref_start`, :any:`gui_ref_step_stop`,</span>
<span class="sd">    :any:`gui_ref_discrete_angles` and :any:`gui_ref_userdef`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    chg_n : bool, optional</span>
<span class="sd">        True if number of LSA cabinets has changed. The default is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ref_array_angles</span><span class="p">(</span><span class="n">PALC_config</span><span class="p">,</span> <span class="n">Ref_arr</span><span class="p">,</span> <span class="n">gui_ref_array</span><span class="p">,</span> \
                         <span class="n">gui_ref_start</span><span class="p">,</span> <span class="n">gui_ref_step_stop</span><span class="p">,</span> \
                         <span class="n">gui_ref_discrete_angles</span><span class="p">,</span> <span class="n">gui_ref_userdef</span><span class="p">)</span>
        <span class="c1"># write to dict to show in DataTable in degree</span>
        <span class="n">gamma_ref_dict</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">gamma_ref</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Ref_arr</span><span class="o">.</span><span class="n">gamma_tilt_deg</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> \
                                   <span class="n">LS</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">PALC_config</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">PALC_config</span><span class="o">.</span><span class="n">N</span><span class="p">))</span>
        <span class="c1"># convert to radian</span>
        <span class="n">Ref_arr</span><span class="o">.</span><span class="n">gamma_n</span> <span class="o">=</span> <span class="n">Ref_arr</span><span class="o">.</span><span class="n">gamma_tilt_deg</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">chg_n</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;Error: Could not process the input&#39;</span><span class="p">)</span>
        <span class="n">gui_ref_start</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
        <span class="n">gui_ref_step_stop</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span></div>
        
<span class="c1">#%%##### CALLBACKS SPECIFICALLY USED IN PAGE 4. ALGORITHM #####################</span>

<span class="c1">## Callback to select the weighting method (f.e. -3 dB loss per distance doubling)</span>
<div class="viewcode-block" id="weighting_select"><a class="viewcode-back" href="../main.html#main.weighting_select">[docs]</a><span class="k">def</span> <span class="nf">weighting_select</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Arranges the GUI depending on chosen weighting approach. Runs init PALC</span>
<span class="sd">    calculation by triggering :any:`start_calc`, if &#39;Target Slope&#39; is chosen.</span>
<span class="sd">    Triggered by :any:`gui_weighting`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attr : str</span>
<span class="sd">        Changed attribute (value).</span>
<span class="sd">    old : str</span>
<span class="sd">        Old weighting approach.</span>
<span class="sd">    new : str</span>
<span class="sd">        New weighting approach.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">set_weighting_in</span><span class="p">(</span><span class="n">gui_weighting</span><span class="p">,</span> <span class="n">weighting_plus</span><span class="p">,</span> <span class="n">weighting_minus</span><span class="p">,</span> \
                     <span class="n">weighting_step_size</span><span class="p">,</span> <span class="n">gui_weighting_nu</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">gui_weighting</span><span class="o">.</span><span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Target Slope&#39;</span><span class="p">]:</span>
        <span class="n">start_calc</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">Opt_w</span><span class="o">.</span><span class="n">init</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">SPLoverX_tabs</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#SPLoverX_tab2</span>
        <span class="n">gui_opt_weight_link</span><span class="o">.</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span>
        <span class="n">gui_weighting</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">135</span>
    <span class="k">else</span><span class="p">:</span>
            <span class="n">gui_opt_weight_link</span><span class="o">.</span><span class="n">visible</span><span class="o">=</span><span class="kc">False</span>
            <span class="n">gui_weighting</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">255</span>
    <span class="n">PALC_config</span><span class="o">.</span><span class="n">store_config</span><span class="p">(</span><span class="s1">&#39;use_weighting&#39;</span><span class="p">,</span> <span class="n">gui_weighting</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="n">update_gh_w_select</span><span class="p">(</span><span class="n">gui_weighting</span><span class="p">,</span> <span class="n">gui_gap_handling</span><span class="p">)</span></div>
    
    
<div class="viewcode-block" id="update_weighting_step_size"><a class="viewcode-back" href="../main.html#main.update_weighting_step_size">[docs]</a><span class="k">def</span> <span class="nf">update_weighting_step_size</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates weighting step size to update :any:`gui_weighting_nu` by clicking</span>
<span class="sd">    on :any:`weighting_plus` or :any:`weighting_minus`. Triggered by</span>
<span class="sd">    :any:`weighting_step_size`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attr : str</span>
<span class="sd">        Changed attribute (value).</span>
<span class="sd">    old : str</span>
<span class="sd">        Old step size.</span>
<span class="sd">    new : str</span>
<span class="sd">        New step size.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gui_weighting_nu</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">weighting_step_size</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>
    

<div class="viewcode-block" id="adjust_weighting_plus"><a class="viewcode-back" href="../main.html#main.adjust_weighting_plus">[docs]</a><span class="k">def</span> <span class="nf">adjust_weighting_plus</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Increases :any:`gui_weighting_nu` by :any:`weighting_step_size`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gui_weighting_nu</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">weighting_step_size</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>

   
<div class="viewcode-block" id="adjust_weighting_minus"><a class="viewcode-back" href="../main.html#main.adjust_weighting_minus">[docs]</a><span class="k">def</span> <span class="nf">adjust_weighting_minus</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decreases :any:`gui_weighting_nu` by :any:`weighting_step_size`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gui_weighting_nu</span><span class="o">.</span><span class="n">value</span> <span class="o">-=</span> <span class="nb">float</span><span class="p">(</span><span class="n">weighting_step_size</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="store_weighting_nu"><a class="viewcode-back" href="../main.html#main.store_weighting_nu">[docs]</a><span class="k">def</span> <span class="nf">store_weighting_nu</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stores actual value to calculate weighting factors (nu). Triggered by</span>
<span class="sd">    :any:`gui_weighting_nu`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attr : str</span>
<span class="sd">        Changed attribute (value).</span>
<span class="sd">    old : float</span>
<span class="sd">        Old nu.</span>
<span class="sd">    new : float</span>
<span class="sd">        New nu.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PALC_config</span><span class="o">.</span><span class="n">weighting_nu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">gui_weighting_nu</span><span class="o">.</span><span class="n">value</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="use_fixed_angle"><a class="viewcode-back" href="../main.html#main.use_fixed_angle">[docs]</a><span class="k">def</span> <span class="nf">use_fixed_angle</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enables or disables the the possibility to use a fixed angle for the</span>
<span class="sd">    heighest LSA cabinet. Runs an init of PALC to calculate the possible range</span>
<span class="sd">    of the angle of the fixed loudspeaker. Calls :any:`start_calc` and</span>
<span class="sd">    :any:`get_fixed_angle_borders`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attr : str</span>
<span class="sd">        Changed attribute (value).</span>
<span class="sd">    old : str</span>
<span class="sd">        Old value if fixed angle is used.</span>
<span class="sd">    new : str</span>
<span class="sd">        New value if fixed angle is used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">gui_use_fixed_angles</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;Yes&#39;</span> <span class="ow">and</span> <span class="n">PALC_pal</span><span class="o">.</span><span class="n">pal</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="n">gamma_tilt_deg</span> <span class="o">=</span> <span class="n">get_fixed_angle_borders</span><span class="p">(</span><span class="n">PALC_pal</span><span class="o">.</span><span class="n">pal</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">PALC_config</span><span class="p">)</span>
        <span class="n">Opt_arr</span><span class="o">.</span><span class="n">fixed_angle</span> <span class="o">=</span> <span class="p">[</span><span class="n">gamma_tilt_deg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">gamma_tilt_deg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">gamma_tilt_deg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span>
        <span class="n">gui_fixed_first_angle</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">Opt_arr</span><span class="o">.</span><span class="n">fixed_angle</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Opt_arr</span><span class="o">.</span><span class="n">fixed_angle</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">gui_fixed_first_angle</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Opt_arr</span><span class="o">.</span><span class="n">fixed_angle</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gui_fixed_first_angle</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Opt_arr</span><span class="o">.</span><span class="n">fixed_angle</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">fixed_angle_text</span><span class="p">,</span> <span class="s1">&#39;Max: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Opt_arr</span><span class="o">.</span><span class="n">fixed_angle</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span> \
                    <span class="s1">&#39;, Min: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Opt_arr</span><span class="o">.</span><span class="n">fixed_angle</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
        <span class="n">PALC_config</span><span class="o">.</span><span class="n">use_fixed_angle</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">gui_use_fixed_angles</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;No&#39;</span><span class="p">:</span>
        <span class="n">gui_fixed_first_angle</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">Opt_arr</span><span class="o">.</span><span class="n">fixed_angle</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">PALC_config</span><span class="o">.</span><span class="n">use_fixed_angle</span> <span class="o">=</span> <span class="kc">False</span></div>
        

<div class="viewcode-block" id="start_calc"><a class="viewcode-back" href="../main.html#main.start_calc">[docs]</a><span class="k">def</span> <span class="nf">start_calc</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main routine of the application. Runs the PALC algorithm with given setting</span>
<span class="sd">    venue slice by the user. Always calls :any:`get_initial_weights`,</span>
<span class="sd">    :py:meth:`calcPALC` or :any:`optimize_PALC`, respectively, :any:`get_plot_array`,</span>
<span class="sd">    :any:`venue_slice2CDS`, :any:`calc_diff_tilt_angles`,</span>
<span class="sd">    :any:`LSA_visualization`, :any:`calcSFP`, :any:`calcSPLoverX`,</span>
<span class="sd">    :any:`calcHomogeneity`, :any:`calcHistogram`. Triggered by :any:`gui_start`</span>
<span class="sd">    and for initialization by :any:`weighting_select` and :any:`use_fixed_angle`.</span>
<span class="sd">    Saves all output in belonging :py:class:`bokeh.models.ColumnDataSource` to</span>
<span class="sd">    visualize the output and sets the ranges of the figures.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    arg : bool</span>
<span class="sd">        If false, return nothing.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">arg</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">PALC_pal</span><span class="o">.</span><span class="n">pal</span> <span class="o">==</span> <span class="p">[]:</span>
        <span class="n">gui_start</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;Error: Please CREATE and GET PALC compatible venue proposal on page 1.&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="c1"># Start the PALC algorithm</span>
    <span class="n">PALC_config</span><span class="o">.</span><span class="n">get_initial_weights</span><span class="p">()</span>
<span class="c1">#    PALC_plots     = PALC_classes.PALC_plotting()</span>
    <span class="c1">###################### RUN THE CALCUlATION ####################################</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># weighting optimization here    </span>
        <span class="k">if</span> <span class="n">PALC_config</span><span class="o">.</span><span class="n">use_weighting</span> <span class="o">==</span> <span class="s1">&#39;Target Slope&#39;</span> <span class="ow">and</span> <span class="n">Opt_w</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">SPL</span> <span class="o">=</span> <span class="n">SPLoverX_dict</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">SPLoverX_dict</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SPL&#39;</span><span class="p">]</span>
            <span class="n">Opt_w</span><span class="o">.</span><span class="n">calc_init</span><span class="p">()</span>
            <span class="c1"># move reference</span>
            <span class="c1">#Opt_w.maxonref(0)</span>
            <span class="n">Opt_SPLoverX_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">SPL</span><span class="p">)))</span>
            <span class="c1"># start optimization, last input is max loops (default=40)</span>
            <span class="n">opt_ind</span> <span class="o">=</span> <span class="n">optimize_PALC</span><span class="p">(</span><span class="n">PALC_config</span><span class="p">,</span> <span class="n">SFP_config</span><span class="p">,</span> <span class="n">PALC_pal</span><span class="p">,</span> <span class="n">PALC_plots</span><span class="p">,</span> \
                                    <span class="n">Opt_arr</span><span class="p">,</span> <span class="n">created_pal</span><span class="p">,</span> <span class="n">Tech_res</span><span class="p">,</span> <span class="n">SPLoverX</span><span class="p">,</span> <span class="n">Opt_w</span><span class="p">,</span> \
                                    <span class="mi">200</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">calcPALC</span><span class="o">.</span><span class="n">calcPALC</span><span class="p">(</span><span class="n">PALC_plots</span><span class="p">,</span> <span class="n">PALC_pal</span><span class="p">,</span> <span class="n">PALC_config</span><span class="p">,</span> <span class="n">Opt_arr</span><span class="p">)</span>        
    <span class="k">except</span><span class="p">:</span>
        <span class="n">gui_start</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;Error: PALC calculation failed&#39;</span><span class="p">)</span>
    <span class="c1">###############################################################################</span>
    <span class="c1"># reset some possibly changed values...</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="p">[[</span><span class="s1">&#39;last_angle_hm&#39;</span><span class="p">,</span> <span class="p">[]],[</span><span class="s1">&#39;x_H&#39;</span><span class="p">,</span> <span class="n">gui_x_H</span><span class="o">.</span><span class="n">value</span><span class="p">],</span> \
                     <span class="p">[</span><span class="s1">&#39;y_H&#39;</span><span class="p">,</span> <span class="n">gui_y_H</span><span class="o">.</span><span class="n">value</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;psi_n&#39;</span><span class="p">,</span> <span class="n">gui_psi_n</span><span class="o">.</span><span class="n">value</span><span class="p">]]:</span>
        <span class="n">PALC_config</span><span class="o">.</span><span class="n">store_config</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
    <span class="c1"># case no convergence reached and calcPALC returned by except-case</span>
    <span class="k">if</span> <span class="n">Opt_arr</span><span class="o">.</span><span class="n">num_iter</span> <span class="o">==</span> <span class="mi">500</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">Opt_arr</span><span class="o">.</span><span class="n">gamma_tilt_deg</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;Error: No convergence reached&#39;</span><span class="p">)</span>
        <span class="n">gui_start</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="c1"># save / copy results to plot in ColumnDataSourcee</span>
    <span class="k">try</span><span class="p">:</span>    
        <span class="n">x_patches</span><span class="p">,</span> <span class="n">y_patches</span> <span class="o">=</span> <span class="n">LSA_visualization</span><span class="p">(</span><span class="n">PALC_plots</span><span class="p">,</span> <span class="n">PALC_config</span><span class="p">,</span> <span class="n">Opt_arr</span><span class="o">.</span><span class="n">gamma_n</span><span class="p">)</span>
        <span class="n">plot_patches</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">x_list</span><span class="o">=</span><span class="n">x_patches</span><span class="p">,</span> <span class="n">y_list</span><span class="o">=</span><span class="n">y_patches</span><span class="p">,</span> \
                                      <span class="n">x_list_ref</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">PALC_config</span><span class="o">.</span><span class="n">N</span><span class="p">),</span> \
                                      <span class="n">y_list_ref</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">PALC_config</span><span class="o">.</span><span class="n">N</span><span class="p">)))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">gui_start</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;Error: Could not store the output&#39;</span><span class="p">)</span>
        <span class="k">return</span>         
    <span class="k">try</span><span class="p">:</span>
        <span class="n">PALC_plots</span><span class="o">.</span><span class="n">get_plot_array</span><span class="p">(</span><span class="n">Opt_arr</span><span class="p">)</span>
        <span class="n">venue_slice2CDS</span><span class="p">(</span><span class="n">plt_venue_slice_1</span><span class="p">,</span> <span class="n">plt_venue_slice_2</span><span class="p">,</span> \
                        <span class="n">PALC_plots</span><span class="p">,</span> <span class="n">Opt_arr</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">venue_slice2CDS</span><span class="p">(</span><span class="n">plt_venue_slice_1</span><span class="p">,</span> <span class="n">plt_venue_slice_2</span><span class="p">,</span> \
                        <span class="p">[],</span> <span class="p">[])</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;Error: Could not store the output&#39;</span><span class="p">)</span>
        <span class="n">gui_start</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span>       
    <span class="c1"># Prepare the data output (results) and save them in a dictionary</span>
    <span class="n">gamma_tilt_deg_diff</span><span class="p">,</span> <span class="n">gamma_tilt_deg_round</span> <span class="o">=</span> <span class="n">calc_diff_tilt_angles</span><span class="p">(</span><span class="n">Opt_arr</span><span class="o">.</span><span class="n">gamma_tilt_deg</span><span class="p">)</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">Opt_arr</span><span class="p">,</span> <span class="s1">&#39;gamma_tilt_deg_diff&#39;</span><span class="p">,</span> <span class="n">gamma_tilt_deg_diff</span><span class="p">)</span>
    <span class="n">results_dict</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a_num_LS</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">PALC_config</span><span class="o">.</span><span class="n">N</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">PALC_config</span><span class="o">.</span><span class="n">N</span><span class="p">),</span> \
                             <span class="n">b_gamma_tilt_deg</span><span class="o">=</span><span class="n">gamma_tilt_deg_round</span><span class="p">,</span> \
                             <span class="n">c_gamma_tilt_deg_diff</span><span class="o">=</span><span class="n">gamma_tilt_deg_diff</span><span class="p">)</span>
    <span class="c1">############## Calculate the Sound Field Prediction and put the results in the dictionaries ######################## </span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">x_S</span><span class="p">,</span> <span class="n">y_S</span> <span class="o">=</span> <span class="n">calcSFP</span><span class="p">(</span><span class="n">Opt_arr</span><span class="o">.</span><span class="n">gamma_tilt_deg</span><span class="p">,</span> <span class="n">created_pal</span><span class="p">,</span> <span class="n">SFP_config</span><span class="p">,</span> \
                           <span class="n">Tech_res</span><span class="p">)</span><span class="c1">#, dir_meas_LSA, dir_meas_degree)</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">t2</span><span class="o">-</span><span class="n">t1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;elapsed time for SFP in s: &#39;</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">gui_start</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;Error: SFP calculation failed&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1">################## Calculation for SPL over distance ###########################################################</span>
    <span class="n">calcSPLoverX</span><span class="p">(</span><span class="n">PALC_plots</span><span class="p">,</span> <span class="n">created_pal</span><span class="p">,</span> <span class="n">Tech_res</span><span class="o">.</span><span class="n">p_SPL</span><span class="p">,</span> <span class="n">SPLoverX</span><span class="p">,</span> <span class="n">SFP_config</span><span class="o">.</span><span class="n">freq_range</span><span class="p">)</span>
    <span class="c1">####### Calculate the Homogeneity and Bar Chart #############</span>
    <span class="n">calcHomogeneity</span><span class="p">(</span><span class="n">Tech_res</span><span class="p">,</span> <span class="n">x_S</span><span class="p">,</span> <span class="n">y_S</span><span class="p">,</span> <span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">,</span> <span class="n">created_pal</span><span class="o">.</span><span class="n">yline</span><span class="p">)</span> 
    <span class="n">calcHistogram</span><span class="p">(</span><span class="n">Tech_res</span><span class="p">)</span>
    <span class="c1">################# Calculation of reference array #############################################################</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">x_S</span><span class="p">,</span> <span class="n">y_S</span> <span class="o">=</span> <span class="n">calcSFP</span><span class="p">(</span><span class="n">Ref_arr</span><span class="o">.</span><span class="n">gamma_tilt_deg</span><span class="p">,</span> <span class="n">created_pal</span><span class="p">,</span> <span class="n">SFP_config</span><span class="p">,</span> \
                           <span class="n">Tech_res_ref</span><span class="p">)</span><span class="c1">#, dir_meas_LSA, dir_meas_degree)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">gui_start</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;Error: SFP calculation of reference array failed&#39;</span><span class="p">)</span>

    <span class="n">x_patches_ref</span><span class="p">,</span> <span class="n">y_patches_ref</span> <span class="o">=</span> <span class="n">LSA_visualization</span><span class="p">(</span><span class="n">PALC_plots_ref</span><span class="p">,</span> <span class="n">PALC_config</span><span class="p">,</span> \
                                                     <span class="n">Ref_arr</span><span class="o">.</span><span class="n">gamma_n</span><span class="p">)</span>
    <span class="n">calcSPLoverX</span><span class="p">(</span><span class="n">PALC_plots_ref</span><span class="p">,</span> <span class="n">created_pal</span><span class="p">,</span> <span class="n">Tech_res_ref</span><span class="o">.</span><span class="n">p_SPL</span><span class="p">,</span> <span class="n">SPLoverX_ref</span><span class="p">,</span> <span class="n">SFP_config</span><span class="o">.</span><span class="n">freq_range</span><span class="p">)</span>
    <span class="n">calcHomogeneity</span><span class="p">(</span><span class="n">Tech_res_ref</span><span class="p">,</span> <span class="n">x_S</span><span class="p">,</span> <span class="n">y_S</span><span class="p">,</span> <span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">,</span> <span class="n">created_pal</span><span class="o">.</span><span class="n">yline</span><span class="p">)</span>
    <span class="n">calcHistogram</span><span class="p">(</span><span class="n">Tech_res_ref</span><span class="p">)</span>
    <span class="c1">############# Plot and save to plot dictionaries ##########################</span>
    <span class="c1"># Sound Field Prediction</span>
    <span class="n">SFPv_dict</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">x_vert</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">,</span> <span class="n">y_vert</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">yline</span><span class="p">,</span> \
                          <span class="n">foo</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">)[</span><span class="mi">0</span><span class="p">])))</span>
    <span class="n">pSFPv</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="s1">&#39;x_vert&#39;</span><span class="p">,</span><span class="s1">&#39;y_vert&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SFPv_dict</span><span class="p">,</span> \
            <span class="n">color</span><span class="o">=</span><span class="n">linear_cmap</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">rainbow</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">p_SPL</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">SFP_dict</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">p_SPL</span><span class="o">=</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">plot_p_SPL</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">plot_f</span><span class="p">,</span> \
                         <span class="n">foo</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">plot_p_SPL</span><span class="p">)[</span><span class="mi">0</span><span class="p">])),</span> \
                         <span class="n">p_SPL_ref</span><span class="o">=</span><span class="n">Tech_res_ref</span><span class="o">.</span><span class="n">plot_p_SPL</span><span class="p">)</span>
    <span class="n">pSFP</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;p_SPL&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SFP_dict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">linear_cmap</span><span class="p">(</span><span class="n">field_name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> \
                    <span class="n">palette</span><span class="o">=</span><span class="n">rainbow</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">p_SPL</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> \
                    <span class="n">line_alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
    <span class="n">pSFPref</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;p_SPL_ref&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SFP_dict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">linear_cmap</span><span class="p">(</span><span class="n">field_name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> \
                       <span class="n">palette</span><span class="o">=</span><span class="n">rainbow</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">Tech_res_ref</span><span class="o">.</span><span class="n">p_SPL</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> \
                       <span class="n">line_alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Opt_w</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
        <span class="n">shift_ref_on_zero</span><span class="p">(</span><span class="n">Opt_w</span><span class="p">,</span> <span class="n">SPLoverX</span><span class="p">,</span> <span class="n">SPLoverX_ref</span><span class="p">)</span>
        <span class="n">SPLoverX_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="n">SPLoverX</span><span class="o">.</span><span class="n">SPL</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">SPLoverX</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> \
                                   <span class="n">x_v</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">,</span> <span class="n">y_v</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">yline</span><span class="p">))</span>
        <span class="n">SPLoverX_ref_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="n">SPLoverX_ref</span><span class="o">.</span><span class="n">SPL</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">SPLoverX_ref</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> \
                                   <span class="n">x_v</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">,</span> <span class="n">y_v</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">yline</span><span class="p">))</span>
        <span class="n">Opt_SPLoverX_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="p">[</span><span class="n">SPLoverX</span><span class="o">.</span><span class="n">SPL</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SPLoverX</span><span class="o">.</span><span class="n">SPL</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> \
                                           <span class="n">x</span>  <span class="o">=</span><span class="p">[</span><span class="n">SPLoverX</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SPLoverX</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> \
                                           <span class="n">x_v</span><span class="o">=</span><span class="p">[</span><span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> \
                                           <span class="n">y_v</span><span class="o">=</span><span class="p">[</span><span class="n">created_pal</span><span class="o">.</span><span class="n">yline</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">created_pal</span><span class="o">.</span><span class="n">yline</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]))</span>
        <span class="n">Opt_refpoint_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">x_ref</span><span class="o">=</span><span class="p">[</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">x_interp</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">x_interp</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)]],</span> \
                                           <span class="n">SPL</span>  <span class="o">=</span><span class="p">[</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">SPL_interp</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">SPL_interp</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)]],</span> \
                                           <span class="n">x_v</span>  <span class="o">=</span><span class="p">[</span><span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)]],</span> \
                                           <span class="n">y_v</span>  <span class="o">=</span><span class="p">[</span><span class="n">created_pal</span><span class="o">.</span><span class="n">yline</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">created_pal</span><span class="o">.</span><span class="n">yline</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)]]))</span>
    <span class="k">elif</span> <span class="n">PALC_config</span><span class="o">.</span><span class="n">use_weighting</span> <span class="o">==</span> <span class="s1">&#39;Target Slope&#39;</span> <span class="ow">and</span> <span class="n">Opt_w</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
        <span class="n">shift2ref</span><span class="p">(</span><span class="n">Opt_w</span><span class="p">,</span> <span class="n">SPLoverX</span><span class="p">,</span> <span class="n">opt_ind</span><span class="p">,</span> <span class="n">SPLoverX_ref</span><span class="p">)</span>
        <span class="n">get_opt_region</span><span class="p">(</span><span class="n">SPLoverX</span><span class="p">,</span> <span class="n">Opt_w</span><span class="p">)</span>
        <span class="n">SPLoverX_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="n">SPLoverX</span><span class="o">.</span><span class="n">SPL</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">SPLoverX</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> \
                                       <span class="n">x_v</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">,</span> <span class="n">y_v</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">yline</span><span class="p">))</span>
        <span class="n">Opt_SPLoverX_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">SPL</span><span class="p">))</span>
        <span class="n">Opt_refpoint_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="p">[</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">SPL_interp</span><span class="p">[</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">ref_ind</span><span class="p">]]))</span>
        <span class="n">SPLoverX_ref_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="n">SPLoverX_ref</span><span class="o">.</span><span class="n">SPL</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">SPLoverX_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="n">SPLoverX</span><span class="o">.</span><span class="n">SPL</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">SPLoverX</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> \
                                       <span class="n">x_v</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">,</span> <span class="n">y_v</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">yline</span><span class="p">))</span>
        <span class="n">SPLoverX_ref_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="n">SPLoverX_ref</span><span class="o">.</span><span class="n">SPL</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">SPLoverX_ref</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> \
                                   <span class="n">x_v</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">,</span> <span class="n">y_v</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">yline</span><span class="p">))</span>
    <span class="c1"># Homogeneity</span>
    <span class="n">Homogeneity_dict</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">H</span><span class="o">=</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> \
                                 <span class="n">H_dist_high</span><span class="o">=</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">H_dist</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> \
                                 <span class="n">H_dist_low</span><span class="o">=</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">H_dist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> \
                                 <span class="n">H_str</span><span class="o">=</span><span class="n">Tech_res_ref</span><span class="o">.</span><span class="n">H</span><span class="p">)</span>
    <span class="c1"># Histogram</span>
    <span class="n">Bar_dict</span><span class="o">.</span><span class="n">data</span>     <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">Hist_tops</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">Hist_steps</span><span class="p">)</span>
    <span class="n">Bar_dict_ref</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">top_ref</span><span class="o">=</span><span class="n">Tech_res_ref</span><span class="o">.</span><span class="n">Hist_tops</span><span class="p">,</span> \
                             <span class="n">x_ref</span><span class="o">=</span><span class="n">Tech_res_ref</span><span class="o">.</span><span class="n">Hist_steps</span><span class="p">)</span>
    <span class="c1"># Set Ranges for SFP, Venue Slice, Homogeneity and Bar Chart</span>
    <span class="c1"># Bar Chart</span>
    <span class="n">bar_range</span>     <span class="o">=</span> <span class="n">plt_ranges</span><span class="o">.</span><span class="n">update_range</span><span class="p">(</span><span class="s1">&#39;bar_range&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> \
                                            <span class="n">Tech_res</span><span class="o">.</span><span class="n">Hist_steps</span><span class="p">,</span> \
                                            <span class="n">Tech_res_ref</span><span class="o">.</span><span class="n">Hist_steps</span><span class="p">)</span>
    <span class="n">bar_top_range</span> <span class="o">=</span> <span class="n">plt_ranges</span><span class="o">.</span><span class="n">update_range</span><span class="p">(</span><span class="s1">&#39;bartop&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> \
                                            <span class="n">Tech_res</span><span class="o">.</span><span class="n">Hist_tops</span><span class="p">,</span> \
                                            <span class="n">Tech_res_ref</span><span class="o">.</span><span class="n">Hist_tops</span><span class="p">)</span>
    <span class="n">pBar</span><span class="o">.</span><span class="n">x_range</span><span class="p">,</span> <span class="n">pBar</span><span class="o">.</span><span class="n">y_range</span>       <span class="o">=</span> <span class="n">bar_range</span><span class="p">,</span> <span class="n">bar_top_range</span>
    <span class="n">pBarref</span><span class="o">.</span><span class="n">x_range</span><span class="p">,</span> <span class="n">pBarref</span><span class="o">.</span><span class="n">y_range</span> <span class="o">=</span> <span class="n">bar_range</span><span class="p">,</span> <span class="n">bar_top_range</span>   
    <span class="c1"># Homogeneity</span>
    <span class="n">hom_y_range</span>  <span class="o">=</span> <span class="n">plt_ranges</span><span class="o">.</span><span class="n">update_range</span><span class="p">(</span><span class="s1">&#39;h_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">Tech_res</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> \
                                           <span class="n">Tech_res_ref</span><span class="o">.</span><span class="n">H</span><span class="p">)</span>
    <span class="n">pHom</span><span class="o">.</span><span class="n">y_range</span> <span class="o">=</span> <span class="n">hom_y_range</span>                                        
    <span class="c1"># SFP</span>
    <span class="n">psfp_y_range</span> <span class="o">=</span> <span class="n">plt_ranges</span><span class="o">.</span><span class="n">update_range</span><span class="p">(</span><span class="s1">&#39;sfp_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">Tech_res</span><span class="o">.</span><span class="n">p_SPL</span><span class="p">,</span> \
                                           <span class="n">Tech_res_ref</span><span class="o">.</span><span class="n">p_SPL</span><span class="p">)</span>
    <span class="n">pSFP</span><span class="o">.</span><span class="n">y_range</span><span class="p">,</span> <span class="n">pSFPref</span><span class="o">.</span><span class="n">y_range</span> <span class="o">=</span> <span class="n">psfp_y_range</span><span class="p">,</span> <span class="n">psfp_y_range</span>
    <span class="c1"># SPLoverX</span>
    <span class="n">SPLoverX_y_range</span> <span class="o">=</span> <span class="n">plt_ranges</span><span class="o">.</span><span class="n">update_range</span><span class="p">(</span><span class="s1">&#39;SPLoverX_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">Opt_w</span><span class="o">.</span><span class="n">SPL_interp</span><span class="p">,</span> \
                                               <span class="n">SPLoverX</span><span class="o">.</span><span class="n">SPL_interp</span><span class="p">,</span> <span class="n">SPLoverX</span><span class="o">.</span><span class="n">SPL</span><span class="p">,</span> \
                                               <span class="n">SPLoverX_ref</span><span class="o">.</span><span class="n">SPL</span><span class="p">)</span>
    <span class="n">pSPLoverX</span><span class="o">.</span><span class="n">y_range</span> <span class="o">=</span> <span class="n">SPLoverX_y_range</span>
    <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">gui_which_beam</span><span class="o">.</span><span class="n">active</span><span class="p">,</span> <span class="n">gui_which_beam</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="p">[],</span> <span class="kc">False</span>
    <span class="c1"># Array visualization</span>
    <span class="n">plot_patches</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">x_list</span><span class="o">=</span><span class="n">x_patches</span><span class="p">,</span> <span class="n">y_list</span><span class="o">=</span><span class="n">y_patches</span><span class="p">,</span> \
                                  <span class="n">x_list_ref</span><span class="o">=</span><span class="n">x_patches_ref</span><span class="p">,</span> \
                                  <span class="n">y_list_ref</span><span class="o">=</span><span class="n">y_patches_ref</span><span class="p">))</span>
    <span class="n">gui_start</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">steps</span><span class="p">()</span></div>


<div class="viewcode-block" id="clear_result_fig"><a class="viewcode-back" href="../main.html#main.clear_result_fig">[docs]</a><span class="k">def</span> <span class="nf">clear_result_fig</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Clears the venue slice plot. Calls :any:`venue_slice2CDS`. Triggered by</span>
<span class="sd">       :any:`gui_clear_result_fig` and in some cases by :any:`steps`. &quot;&quot;&quot;</span>
    <span class="n">venue_slice2CDS</span><span class="p">(</span><span class="n">plt_venue_slice_1</span><span class="p">,</span> <span class="n">plt_venue_slice_2</span><span class="p">,</span> \
                    <span class="p">[],</span> <span class="p">[])</span></div>
        

<span class="c1">#%%### CALLBACKS USED ON MORE THAN ONE PAGE OR IN 5. SOUND FIELD PREDICTION ###</span>

<div class="viewcode-block" id="get_value"><a class="viewcode-back" href="../main.html#main.get_value">[docs]</a><span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function saves the user input of many widgets into the config objects</span>
<span class="sd">    PALC_config and SFP_config by calling :any:`store_config`. The widgets that</span>
<span class="sd">    trigger this function are:</span>
<span class="sd">        </span>
<span class="sd">        * :any:`gui_x_H` -  Highest front point of the LSA on the x-axis</span>
<span class="sd">        * :any:`gui_y_H` -  Highest front point of the LSA on the y-axis</span>
<span class="sd">        * :any:`gui_Lambda_y` - Height of the loudspeakers</span>
<span class="sd">        * :any:`gui_Lambda_gap` - Distance between adjacent LSA cabinets</span>
<span class="sd">        * :any:`gui_PALC_alg` -  Algorithm type (PALC1, PALC2 or PALC3)</span>
<span class="sd">        * :any:`gui_N_LS` - Number of LSA cabinets</span>
<span class="sd">        * :any:`gui_psi_n` - Initialization aperture angle of LSA cabinets</span>
<span class="sd">        * :any:`gui_use_dangles` - Selection it continuous or discrete tilt angles</span>
<span class="sd">          shall be used (does not trigger this function directly)</span>
<span class="sd">        * :any:`gui_gap_handling` - Gap handling approach (Without, Soft or Hard Margin)</span>
<span class="sd">        * :any:`gui_strength_smarg` - Strength of the soft margin gap handling approach</span>
<span class="sd">        * :any:`gui_directivity` - Loudspeaker directivity (Circular Piston, Line</span>
<span class="sd">          Piston, Combined Circular and Line Piston or Measured Loudspeaker Data)</span>
<span class="sd">        * :any:`gui_fixed_first_angle` - If the highest LSA cabinet shall be</span>
<span class="sd">          mounted with a fixed tilt angle, this widget takes the fixed angle in</span>
<span class="sd">          degree.</span>
<span class="sd">          </span>
<span class="sd">    If entered value cannot be stored, the default values will be used. Calls also</span>
<span class="sd">    :any:`get_ref_array_angles` if the value of :any:`gui_use_dangles` or :any:`gui_N_LS`</span>
<span class="sd">    has changed. Always calls :any:`round_fixed_angle`, :any:`choose_gap_handling`,</span>
<span class="sd">    :any:`update_gh_w_select` and :any:`init_dir_plot`. Updates ranges of figures.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attr : str</span>
<span class="sd">        Changed attribute (value).</span>
<span class="sd">    old : either str, int, float</span>
<span class="sd">        Old value of changed attribute of triggered widget.</span>
<span class="sd">    new : either str, int, float</span>
<span class="sd">        New value of changed attribute of triggered widget.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># make dictionary of possible widgets to evaluate</span>
    <span class="n">widget_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;constraint&#39;</span><span class="p">:</span><span class="n">gui_PALC_alg</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> \
                   <span class="s1">&#39;use_gamma_LSA&#39;</span><span class="p">:</span><span class="n">gui_use_dangles</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> \
                   <span class="s1">&#39;gap_handling&#39;</span><span class="p">:</span><span class="n">gui_gap_handling</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> \
                   <span class="s1">&#39;strength_sm&#39;</span><span class="p">:</span><span class="n">gui_strength_smarg</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> \
                   <span class="s1">&#39;Lambda_y&#39;</span><span class="p">:</span><span class="n">gui_Lambda_y</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> \
                   <span class="s1">&#39;Lambda_gap&#39;</span><span class="p">:</span><span class="n">gui_Lambda_gap</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> \
                   <span class="s1">&#39;directivity&#39;</span><span class="p">:</span><span class="n">gui_directivity</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> \
                   <span class="s1">&#39;fixed_angle&#39;</span><span class="p">:</span><span class="n">gui_fixed_first_angle</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> \
                   <span class="s1">&#39;x_H&#39;</span><span class="p">:</span><span class="n">gui_x_H</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;y_H&#39;</span><span class="p">:</span><span class="n">gui_y_H</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> \
                   <span class="s1">&#39;N&#39;</span><span class="p">:</span><span class="n">gui_N_LS</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> \
                   <span class="s1">&#39;psi_n&#39;</span><span class="p">:</span><span class="n">gui_psi_n</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;tolerance&#39;</span><span class="p">:</span><span class="n">gui_tolerance</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> \
                   <span class="s1">&#39;freq_range&#39;</span><span class="p">:</span><span class="n">gui_freq_range</span><span class="o">.</span><span class="n">value</span><span class="p">}</span>
    <span class="c1"># iterate over widget_dict to detect changed value and store in object</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">widget_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">new</span> <span class="o">==</span> <span class="n">val</span><span class="p">:</span>
            <span class="n">error_info</span><span class="p">,</span> <span class="n">failed_key</span> <span class="o">=</span> <span class="n">PALC_config</span><span class="o">.</span><span class="n">store_config</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="c1"># if wrong user input --&gt; insert default value</span>
            <span class="k">if</span> <span class="n">failed_key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Lambda_y&#39;</span><span class="p">]</span>    <span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">gui_Lambda_y</span><span class="p">,</span><span class="n">attr</span><span class="p">,</span><span class="s1">&#39;0.2&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">failed_key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span>           <span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">gui_N_LS</span><span class="p">,</span><span class="n">attr</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">)</span> 
            <span class="k">if</span> <span class="n">failed_key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Lambda_gap&#39;</span><span class="p">]</span>  <span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">gui_Lambda_gap</span><span class="p">,</span><span class="n">attr</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">failed_key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;tolerance&#39;</span><span class="p">]</span>   <span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">gui_tolerance</span><span class="p">,</span><span class="n">attr</span><span class="p">,</span><span class="s1">&#39;0.1&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">failed_key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;fixed_angle&#39;</span><span class="p">]</span> <span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">gui_fixed_first_angle</span><span class="p">,</span><span class="n">attr</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">failed_key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x_H&#39;</span><span class="p">]</span>         <span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">gui_x_H</span><span class="p">,</span><span class="n">attr</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">failed_key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;y_H&#39;</span><span class="p">]</span>         <span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">gui_y_H</span><span class="p">,</span><span class="n">attr</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">failed_key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;too low&#39;</span><span class="p">]</span>     <span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">gui_y_H</span><span class="p">,</span><span class="n">attr</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">PALC_config</span><span class="o">.</span><span class="n">y_H</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">failed_key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;psi_n&#39;</span><span class="p">]</span>       <span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">gui_psi_n</span><span class="p">,</span><span class="n">attr</span><span class="p">,</span><span class="s1">&#39;0.0524&#39;</span><span class="p">)</span>
            <span class="c1"># Set attribute in SFP_config if possible</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">SFP_config</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="ow">and</span> <span class="n">failed_key</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;too low&#39;</span><span class="p">]:</span> 
                <span class="n">SFP_config</span><span class="o">.</span><span class="n">store_config</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
            <span class="n">update_text</span><span class="p">(</span><span class="n">config_error_info</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">error_info</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;use_gamma_LSA&#39;</span><span class="p">]:</span>
                <span class="n">get_ref_array_angles</span><span class="p">(</span><span class="n">chg_n</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># round fixed angle of heighest LS</span>
    <span class="n">round_fixed_angle</span><span class="p">(</span><span class="n">PALC_config</span><span class="p">,</span> <span class="n">Opt_arr</span><span class="p">,</span> <span class="n">gui_fixed_first_angle</span><span class="p">)</span>
    <span class="c1"># set chosen gap_handling</span>
    <span class="n">choose_gap_handling</span><span class="p">(</span><span class="n">gui_gap_handling</span><span class="p">,</span> <span class="n">gui_strength_smarg</span><span class="p">)</span>
    <span class="c1"># set options if hard margin or target slope is chosen</span>
    <span class="n">update_gh_w_select</span><span class="p">(</span><span class="n">gui_weighting</span><span class="p">,</span> <span class="n">gui_gap_handling</span><span class="p">)</span>

 <span class="c1"># For the selected Directivity, directly provide the plot for three frequencies          </span>
    <span class="k">if</span> <span class="n">PALC_config</span><span class="o">.</span><span class="n">directivity</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Circular Piston&#39;</span><span class="p">,</span><span class="s1">&#39;Line Piston&#39;</span><span class="p">,</span><span class="s1">&#39;Combined Circular/Line&#39;</span><span class="p">]:</span>
        <span class="n">button_input</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># init of diretivity variables</span>
        <span class="n">c0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta_deg</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">dir_meas</span><span class="p">,</span> <span class="n">dir_meas_deg</span><span class="p">,</span> <span class="n">H_post</span> <span class="o">=</span> <span class="n">init_dir_plot</span><span class="p">()</span> 
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">H_post</span><span class="p">[:,</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">calc_directivity</span><span class="p">(</span><span class="n">PALC_config</span><span class="o">.</span><span class="n">directivity</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> \
                                           <span class="n">PALC_config</span><span class="o">.</span><span class="n">Lambda_y</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">omega</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> \
                                           <span class="n">c0</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">dir_meas</span><span class="p">[:,</span><span class="n">n</span><span class="p">],</span> <span class="n">dir_meas_deg</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">n</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">SFP_config</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="n">SFP_config</span><span class="o">.</span><span class="n">get_plot_dir_amp</span><span class="p">(</span><span class="n">H_post</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">])</span>    
    <span class="c1"># write data in ColumnDataSource that is for directivity plotting</span>
        <span class="n">directivity_dict_plt</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">amplitude_100</span><span class="o">=</span><span class="n">SFP_config</span><span class="o">.</span><span class="n">plot_dir_amp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> \
                                         <span class="n">amplitude_1k</span><span class="o">=</span><span class="n">SFP_config</span><span class="o">.</span><span class="n">plot_dir_amp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> \
                                         <span class="n">amplitude_10k</span><span class="o">=</span><span class="n">SFP_config</span><span class="o">.</span><span class="n">plot_dir_amp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> \
                                         <span class="n">degree</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">beta_deg</span><span class="p">))</span>   
    <span class="c1"># else Measured Loudspeaker Data is selected</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">button_input</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">directivity_dict_plt</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">amplitude_100</span><span class="o">=</span><span class="n">SFP_config</span><span class="o">.</span><span class="n">plot_dir_amp_meas</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> \
                                         <span class="n">amplitude_1k</span><span class="o">=</span><span class="n">SFP_config</span><span class="o">.</span><span class="n">plot_dir_amp_meas</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> \
                                         <span class="n">amplitude_10k</span><span class="o">=</span><span class="n">SFP_config</span><span class="o">.</span><span class="n">plot_dir_amp_meas</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> \
                                         <span class="n">degree</span><span class="o">=</span><span class="n">SFP_config</span><span class="o">.</span><span class="n">plot_beta_meas</span><span class="p">)</span> 
    <span class="c1"># set ranges</span>
    <span class="k">if</span> <span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="n">x_range</span> <span class="o">=</span> <span class="n">plt_ranges</span><span class="o">.</span><span class="n">update_range</span><span class="p">(</span><span class="s1">&#39;p_x&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">created_pal</span><span class="o">.</span><span class="n">xline_start</span><span class="p">,</span> \
                                          <span class="n">created_pal</span><span class="o">.</span><span class="n">xline_stop</span><span class="p">,</span> <span class="n">PALC_config</span><span class="o">.</span><span class="n">x_H</span><span class="p">)</span>
        <span class="n">y_range</span> <span class="o">=</span> <span class="n">plt_ranges</span><span class="o">.</span><span class="n">update_range</span><span class="p">(</span><span class="s1">&#39;p_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">created_pal</span><span class="o">.</span><span class="n">yline_start</span><span class="p">,</span> \
                                          <span class="n">created_pal</span><span class="o">.</span><span class="n">yline_stop</span><span class="p">,</span> <span class="n">PALC_config</span><span class="o">.</span><span class="n">y_H</span><span class="p">)</span>
        <span class="c1"># write ranges to plots</span>
        <span class="n">scale_p_axis</span><span class="p">(</span><span class="n">call</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">set_ranges</span><span class="p">(</span><span class="n">figs</span><span class="o">=</span><span class="p">[</span><span class="n">pBeam</span><span class="p">,</span> <span class="n">pBeam_ref</span><span class="p">,</span> <span class="n">pSFPv</span><span class="p">],</span> <span class="n">sizes</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> \
                   <span class="n">ranges</span><span class="o">=</span><span class="p">[</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">])</span>
        <span class="n">pSPLoverX</span><span class="o">.</span><span class="n">x_range</span> <span class="o">=</span> <span class="n">x_range</span></div>
        
        
<div class="viewcode-block" id="set_ranges"><a class="viewcode-back" href="../main.html#main.set_ranges">[docs]</a><span class="k">def</span> <span class="nf">set_ranges</span><span class="p">(</span><span class="o">**</span><span class="n">fig_rng_sz</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the x- and y-ranges of figures and plots.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    **fig_rng_sz : lists</span>
<span class="sd">        Must contain three argument called figs = [figure], sizes = [bool],</span>
<span class="sd">        ranges = [x_range, y_range].</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">figs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fig_rng_sz</span><span class="p">[</span><span class="s1">&#39;figs&#39;</span><span class="p">]):</span>
        <span class="n">figs</span><span class="o">.</span><span class="n">x_range</span> <span class="o">=</span> <span class="n">fig_rng_sz</span><span class="p">[</span><span class="s1">&#39;ranges&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">figs</span><span class="o">.</span><span class="n">y_range</span> <span class="o">=</span> <span class="n">fig_rng_sz</span><span class="p">[</span><span class="s1">&#39;ranges&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">fig_rng_sz</span><span class="p">[</span><span class="s1">&#39;sizes&#39;</span><span class="p">][</span><span class="n">ind</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">figs</span><span class="o">.</span><span class="n">frame_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> \
                 <span class="n">figs</span><span class="o">.</span><span class="n">frame_width</span> <span class="o">/</span> <span class="p">(</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span></div>
        
        
<div class="viewcode-block" id="scale_p_axis"><a class="viewcode-back" href="../main.html#main.scale_p_axis">[docs]</a><span class="k">def</span> <span class="nf">scale_p_axis</span><span class="p">(</span><span class="n">call</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Changes the sizing mode of the venue slice. Calls therefore</span>
<span class="sd">    :any:`get_p_axis_rng`. Triggered by :any:`p_equal_axis`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    call : bool, optional</span>
<span class="sd">        If True, calls :any:`steps` to update the page. The default is True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">get_p_axis_rng</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">plt_ranges</span><span class="p">,</span> <span class="n">p_equal_axis</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">call</span><span class="p">:</span>
        <span class="n">steps</span><span class="p">()</span></div>
        

<div class="viewcode-block" id="get_beamplot"><a class="viewcode-back" href="../main.html#main.get_beamplot">[docs]</a><span class="k">def</span> <span class="nf">get_beamplot</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the beamplot of PALC results and / or reference array and saves</span>
<span class="sd">    the beamplot data in a dictionary for visualization. Triggered by</span>
<span class="sd">    :any:`gui_f_beam` or :any:`gui_which_beam`. Calls :any:`set_beamplot_visibility`</span>
<span class="sd">    and :any:`getBeamplotRes`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attr : str</span>
<span class="sd">        Changed attribute (Either value or active).</span>
<span class="sd">    old : either float or int</span>
<span class="sd">        Old attribute.</span>
<span class="sd">    new : either float or int</span>
<span class="sd">        New attribute.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># visibility of the plots</span>
        <span class="n">set_beamplot_visibility</span><span class="p">(</span><span class="n">gui_which_beam</span><span class="p">,</span> <span class="n">pBeam</span><span class="p">,</span> <span class="n">pBeam_ref</span><span class="p">)</span>
        <span class="c1"># if frequency is changed, make string to list for if request below</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">old</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">old</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">new</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">new</span><span class="p">)]</span>
        <span class="c1"># Beamplot Calculation    </span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">gui_f_beam</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="c1"># Get indice of frequency for the case of Measured Loudspeaker Data</span>
        <span class="n">ind_f</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="n">SFP_config</span><span class="o">.</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">gui_which_beam</span><span class="o">.</span><span class="n">active</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="mi">0</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">old</span> <span class="ow">and</span> <span class="p">(</span><span class="mi">0</span> <span class="ow">in</span> <span class="n">new</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="n">gui_f_beam</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">new</span><span class="p">):</span>
                <span class="n">p_SPL</span> <span class="o">=</span> <span class="n">getBeamplotRes</span><span class="p">(</span><span class="n">pBeam</span><span class="p">,</span> <span class="n">mapper</span><span class="p">,</span> <span class="n">PALC_config</span><span class="p">,</span> <span class="n">SFP_config</span><span class="p">,</span> \
                                       <span class="n">Opt_arr</span><span class="o">.</span><span class="n">gamma_n</span><span class="p">,</span> <span class="n">plt_ranges</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">ind_f</span><span class="p">)</span>
                <span class="n">Beamplot_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="p">[</span><span class="n">p_SPL</span><span class="p">],</span> \
                                               <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> \
                                               <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> \
                                               <span class="n">dw</span><span class="o">=</span><span class="p">[</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> \
                                               <span class="n">dh</span><span class="o">=</span><span class="p">[</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
            <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="mi">1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">old</span> <span class="ow">and</span> <span class="p">(</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">new</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="n">gui_f_beam</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">new</span><span class="p">):</span>
                <span class="n">p_SPL_ref</span> <span class="o">=</span> <span class="n">getBeamplotRes</span><span class="p">(</span><span class="n">pBeam_ref</span><span class="p">,</span> <span class="n">mapper_ref</span><span class="p">,</span> <span class="n">PALC_config</span><span class="p">,</span> \
                                           <span class="n">SFP_config</span><span class="p">,</span> <span class="n">Ref_arr</span><span class="o">.</span><span class="n">gamma_n</span><span class="p">,</span> <span class="n">plt_ranges</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">ind_f</span><span class="p">)</span>
                <span class="n">Beamplot_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL_ref</span><span class="o">=</span><span class="p">[</span><span class="n">p_SPL_ref</span><span class="p">],</span> \
                                               <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> \
                                               <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> \
                                               <span class="n">dw</span><span class="o">=</span><span class="p">[</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> \
                                               <span class="n">dh</span><span class="o">=</span><span class="p">[</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plt_ranges</span><span class="o">.</span><span class="n">p_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span></div>


<span class="c1">## Function for the TapTool that can be used on the venue slice plot in page 4 (sound field prediction).</span>
<div class="viewcode-block" id="tap_handle"><a class="viewcode-back" href="../main.html#main.tap_handle">[docs]</a><span class="k">def</span> <span class="nf">tap_handle</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the tap tool that can be used in the sound field prediction on page</span>
<span class="sd">    four. Highlites the tapped line or venue point in :any:`pSFPv` and</span>
<span class="sd">    :any:`pSFP`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attr : str</span>
<span class="sd">        Changed attribute (index).</span>
<span class="sd">    old : int</span>
<span class="sd">        Old tapped index.</span>
<span class="sd">    new : TYPE</span>
<span class="sd">        New tapped index.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize and Preparation</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">p_SPL</span><span class="p">,</span> <span class="n">p_SPL_ref</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>        
    <span class="c1"># hide the unchosen lines or show them again (if nothing select or reset)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">new</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">new</span><span class="p">)[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">plot_f</span><span class="p">[</span><span class="n">new</span><span class="p">[</span><span class="n">n</span><span class="p">]])</span>
            <span class="n">p_SPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">plot_p_SPL</span><span class="p">[</span><span class="n">new</span><span class="p">[</span><span class="n">n</span><span class="p">]])</span>
            <span class="n">p_SPL_ref</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Tech_res_ref</span><span class="o">.</span><span class="n">plot_p_SPL</span><span class="p">[</span><span class="n">new</span><span class="p">[</span><span class="n">n</span><span class="p">]])</span>
        <span class="n">SFP_dict</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">p_SPL</span><span class="o">=</span><span class="n">p_SPL</span><span class="p">,</span> \
                             <span class="n">foo</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p_SPL</span><span class="p">)[</span><span class="mi">0</span><span class="p">])),</span> \
                             <span class="n">p_SPL_ref</span><span class="o">=</span><span class="n">p_SPL_ref</span><span class="p">)</span>        
    <span class="k">else</span><span class="p">:</span>
        <span class="n">SFP_dict</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">plot_f</span><span class="p">,</span> <span class="n">p_SPL</span><span class="o">=</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">plot_p_SPL</span><span class="p">,</span> \
                             <span class="n">foo</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">Tech_res</span><span class="o">.</span><span class="n">plot_p_SPL</span><span class="p">)[</span><span class="mi">0</span><span class="p">])),</span> \
                             <span class="n">p_SPL_ref</span><span class="o">=</span><span class="n">Tech_res_ref</span><span class="o">.</span><span class="n">plot_p_SPL</span><span class="p">)</span></div>
            
<span class="c1">## Function to let the user draw the optimal SPL over X</span>
<div class="viewcode-block" id="optimal_SPLoverX"><a class="viewcode-back" href="../main.html#main.optimal_SPLoverX">[docs]</a><span class="k">def</span> <span class="nf">optimal_SPLoverX</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Triggered if user draws in :any:`pSPLoverX`. Sets is2update attribute of</span>
<span class="sd">    :any:Opt_w` to zero. :any:`Opt_SPLoverX_dict` is automatically updated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Opt_w</span><span class="o">.</span><span class="n">is2update</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">pass</span></div>
    <span class="c1"># Nothing to do, updating the CDS works automatically</span>
    <span class="c1"># Afterwards def update_draw(attr, old, new) is called</span>

<div class="viewcode-block" id="chg_weight_links"><a class="viewcode-back" href="../main.html#main.chg_weight_links">[docs]</a><span class="k">def</span> <span class="nf">chg_weight_links</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the number of hinges for the target slope weighting optimization.</span>
<span class="sd">    Calls :any:`get_weight_links`. Triggered by :any:`gui_opt_weight_link`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attr : str</span>
<span class="sd">        Changed attribute (value).</span>
<span class="sd">    old : float</span>
<span class="sd">        Old number of hinges in target slope.</span>
<span class="sd">    new : float</span>
<span class="sd">        New number of hinges in target slope.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">get_weight_links</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">new</span><span class="p">),</span> <span class="n">SPLoverX</span><span class="p">)</span>
    <span class="n">Opt_SPLoverX_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SPL</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">SPLoverX</span><span class="o">.</span><span class="n">SPL</span><span class="p">)[</span><span class="n">ind</span><span class="p">],</span> \
                                           <span class="n">x</span><span class="o">=</span><span class="n">SPLoverX</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> \
                                           <span class="n">x_v</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">xline</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> \
                                           <span class="n">y_v</span><span class="o">=</span><span class="n">created_pal</span><span class="o">.</span><span class="n">yline</span><span class="p">[</span><span class="n">ind</span><span class="p">]))</span></div>


<div class="viewcode-block" id="update_draw"><a class="viewcode-back" href="../main.html#main.update_draw">[docs]</a><span class="k">def</span> <span class="nf">update_draw</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates :any:`Opt_w`, :any:`Opt_SPLoverX_dict` and :any:`SPLoverX_optreg`,</span>
<span class="sd">    when :any:`optimal_SPLoverX` function was triggered. This happens if the</span>
<span class="sd">    target slope weighting is chosen and the user changes the target slope.</span>
<span class="sd">    Triggered by data change of :any:`Opt_SPLoverX_dict`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    attr : str</span>
<span class="sd">        Changed attribute (data).</span>
<span class="sd">    old : float</span>
<span class="sd">        Float point of old data point.</span>
<span class="sd">    new : float</span>
<span class="sd">        Float point of new data point (drawn by user in figure :any:`pSPLoverX`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># change values to smallest and highest real x values or move to nearest</span>
    <span class="c1"># grid point on x axis</span>
    <span class="n">x</span>         <span class="o">=</span> <span class="n">SPLoverX_dict</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
    <span class="n">x_v</span><span class="p">,</span> <span class="n">y_v</span>  <span class="o">=</span> <span class="n">SPLoverX_dict</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x_v&#39;</span><span class="p">],</span> <span class="n">SPLoverX_dict</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;y_v&#39;</span><span class="p">]</span>
    <span class="n">Opt_w</span><span class="o">.</span><span class="n">CDS2obj</span><span class="p">(</span><span class="n">Opt_SPLoverX_dict</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;SPL&#39;</span><span class="p">,</span> <span class="s1">&#39;x_v&#39;</span><span class="p">,</span> <span class="s1">&#39;y_v&#39;</span><span class="p">])</span>
    <span class="n">Opt_w</span><span class="o">.</span><span class="n">CDS2obj</span><span class="p">(</span><span class="n">Opt_refpoint_dict</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x_ref&#39;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">x</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">val</span><span class="p">))</span>
        <span class="n">Opt_w</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span>
        <span class="n">Opt_w</span><span class="o">.</span><span class="n">x_v</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">Opt_w</span><span class="o">.</span><span class="n">y_v</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_v</span><span class="p">[</span><span class="n">arg</span><span class="p">],</span> <span class="n">y_v</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span>
    <span class="c1"># sort CDS so that smaller x value is on indice 0</span>
    <span class="n">Opt_w</span><span class="o">.</span><span class="n">resort_opt_region</span><span class="p">()</span>           
    <span class="n">Opt_w</span><span class="o">.</span><span class="n">x_interp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">Opt_w</span><span class="o">.</span><span class="n">interpolate_SPL</span><span class="p">()</span>
    <span class="c1"># find nearest index for x_ref</span>
    <span class="n">ref_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">x_ref</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">x_interp</span><span class="p">)))</span>
    <span class="n">Opt_w</span><span class="o">.</span><span class="n">x_ref</span><span class="p">,</span> <span class="n">Opt_w</span><span class="o">.</span><span class="n">ref_ind</span> <span class="o">=</span> <span class="n">Opt_w</span><span class="o">.</span><span class="n">x_interp</span><span class="p">[</span><span class="n">ref_ind</span><span class="p">],</span> <span class="n">ref_ind</span>   
    <span class="n">xv_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">x_ref</span><span class="p">))</span>
    <span class="c1">#Opt_w.SPL -= Opt_w.SPL_interp[ref_ind]</span>
    <span class="k">if</span> <span class="n">Opt_w</span><span class="o">.</span><span class="n">is2update</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">Opt_w</span><span class="o">.</span><span class="n">is2update</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">Opt_SPLoverX_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">SPL</span><span class="o">=</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">SPL</span><span class="p">,</span> \
                                           <span class="n">x_v</span><span class="o">=</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">x_v</span><span class="p">,</span> <span class="n">y_v</span><span class="o">=</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">y_v</span><span class="p">))</span>
        <span class="n">Opt_refpoint_dict</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">x_ref</span><span class="o">=</span><span class="p">[</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">x_ref</span><span class="p">],</span> <span class="n">SPL</span><span class="o">=</span><span class="p">[</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">SPL_interp</span><span class="p">[</span><span class="n">ref_ind</span><span class="p">]],</span> \
                                           <span class="n">x_v</span><span class="o">=</span><span class="p">[</span><span class="n">x_v</span><span class="p">[</span><span class="n">xv_ind</span><span class="p">]],</span> <span class="n">y_v</span><span class="o">=</span><span class="p">[</span><span class="n">y_v</span><span class="p">[</span><span class="n">xv_ind</span><span class="p">]]))</span><span class="c1">#SPL=[Opt_w.SPL_interp[ref_ind]], \</span>
    <span class="n">SPLoverX_optreg</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> \
                                     <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">SPL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">100</span><span class="p">,</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">SPL</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> \
                                        <span class="n">Opt_w</span><span class="o">.</span><span class="n">SPL</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="n">Opt_w</span><span class="o">.</span><span class="n">SPL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">100</span><span class="p">]))</span></div>


<div class="viewcode-block" id="steps"><a class="viewcode-back" href="../main.html#main.steps">[docs]</a><span class="k">def</span> <span class="nf">steps</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to place the widgets on the pages. Can also be called to update the</span>
<span class="sd">    a page after a user input, e.g., to make sure that range of a plot is surely</span>
<span class="sd">    updated.</span>
<span class="sd">    Clears the page with :py:class:`bokeh.io.curdoc().clear()`.The arrangement</span>
<span class="sd">    of the widgets is done with :py:class:`bokeh.layouts.row`,</span>
<span class="sd">    :py:class:`bokeh.layouts.column` and :py:class:`bokeh.layouts.gridplot`.</span>
<span class="sd">    The layout is then added to the root by :py:class:`bokeh.io.curdoc().add_root()`.</span>
<span class="sd">    Note: Tab bars could also be used, but would need to have all widgets</span>
<span class="sd">    available in curdoc() the whole time.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">curdoc</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="c1"># shows the select part in the document</span>
    <span class="k">if</span> <span class="n">gui_step</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">row0</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">column</span><span class="p">(</span><span class="n">aklogo</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="n">tublogo</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">170</span><span class="p">),</span>\
                    <span class="n">column</span><span class="p">(</span><span class="n">aklogo2</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="n">gui_step</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">690</span><span class="p">)])</span>
        <span class="n">row1</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">headline</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">1230</span><span class="p">)</span>
        <span class="n">row2</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">help_tabs</span><span class="p">])</span>
        <span class="n">figall</span> <span class="o">=</span> <span class="n">gridplot</span><span class="p">([[</span><span class="n">row0</span><span class="p">],</span> <span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="p">[</span><span class="n">row2</span><span class="p">]],</span> <span class="n">toolbar_location</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> \
                          <span class="n">merge_tools</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>      
        <span class="n">curdoc</span><span class="p">()</span><span class="o">.</span><span class="n">add_root</span><span class="p">(</span><span class="n">figall</span><span class="p">)</span>
    
    <span class="k">elif</span> <span class="n">gui_step</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">clear_result_fig</span><span class="p">()</span>
        <span class="n">col0</span> <span class="o">=</span> <span class="n">column</span><span class="p">([</span><span class="n">xAchse</span><span class="p">,</span> <span class="n">start_point_x</span><span class="p">,</span> <span class="n">end_point_x</span><span class="p">,</span> <span class="n">strich1</span><span class="p">,</span> \
                       <span class="n">line_discretization</span><span class="p">,</span> <span class="n">pal_error_info</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="n">col1</span> <span class="o">=</span> <span class="n">column</span><span class="p">([</span><span class="n">yAchse</span><span class="p">,</span> <span class="n">start_point_y</span><span class="p">,</span> <span class="n">end_point_y</span><span class="p">,</span> <span class="n">strich6</span><span class="p">,</span> \
                       <span class="n">save_line_button</span><span class="p">,</span> <span class="n">remove_line_button</span><span class="p">,</span> \
                       <span class="n">save_prev_line_button</span><span class="p">,</span> <span class="n">remove_sel_line_button</span><span class="p">,</span> \
                       <span class="n">check_PAL_button</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="n">col2</span> <span class="o">=</span> <span class="n">column</span><span class="p">([</span><span class="n">row</span><span class="p">([</span><span class="n">p_equal_axis_dist</span><span class="p">,</span> <span class="n">p_equal_axis</span><span class="p">]),</span> <span class="n">p</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">690</span><span class="p">)</span>
        <span class="n">row0</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">column</span><span class="p">(</span><span class="n">aklogo</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="n">tublogo</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">170</span><span class="p">),</span> \
                    <span class="n">column</span><span class="p">(</span><span class="n">aklogo2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="n">gui_step</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">690</span><span class="p">)])</span>
        <span class="n">row1</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">headline</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">1230</span><span class="p">)</span>
        <span class="n">row2</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">col0</span><span class="p">,</span> <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">])</span>
        <span class="n">figall</span> <span class="o">=</span> <span class="n">gridplot</span><span class="p">([[</span><span class="n">row0</span><span class="p">],[</span><span class="n">row1</span><span class="p">],[</span><span class="n">row2</span><span class="p">]],</span> <span class="n">toolbar_location</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> \
                          <span class="n">merge_tools</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">curdoc</span><span class="p">()</span><span class="o">.</span><span class="n">add_root</span><span class="p">(</span><span class="n">figall</span><span class="p">)</span>
        
    <span class="k">elif</span> <span class="n">gui_step</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">col0</span> <span class="o">=</span> <span class="n">column</span><span class="p">([</span><span class="n">gui_psi_n</span><span class="p">,</span> <span class="n">gui_Lambda_y</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">270</span> <span class="p">)</span>
        <span class="n">col1</span> <span class="o">=</span> <span class="n">column</span><span class="p">([</span><span class="n">gui_directivity</span><span class="p">,</span> <span class="n">button_input</span><span class="p">,</span> <span class="n">config_error_info</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="n">col2</span> <span class="o">=</span> <span class="n">column</span><span class="p">([</span><span class="n">row</span><span class="p">([</span><span class="n">p_equal_axis_dist</span><span class="p">,</span> <span class="n">p_equal_axis</span><span class="p">]),</span> <span class="n">dir_tabs</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">690</span><span class="p">)</span>
        <span class="n">row0</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">column</span><span class="p">(</span><span class="n">aklogo</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="n">tublogo</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">170</span><span class="p">),</span> \
                    <span class="n">column</span><span class="p">(</span><span class="n">aklogo2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="n">gui_step</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">690</span><span class="p">)])</span>
        <span class="n">row1</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">headline</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">1230</span><span class="p">)</span>
        <span class="n">row2</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">col0</span><span class="p">,</span> <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">])</span>
        <span class="n">figall</span> <span class="o">=</span> <span class="n">gridplot</span><span class="p">([[</span><span class="n">row0</span><span class="p">],[</span><span class="n">row1</span><span class="p">],[</span><span class="n">row2</span><span class="p">]],</span> <span class="n">toolbar_location</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> \
                          <span class="n">merge_tools</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">curdoc</span><span class="p">()</span><span class="o">.</span><span class="n">add_root</span><span class="p">(</span><span class="n">figall</span><span class="p">)</span>
    
    <span class="k">elif</span> <span class="n">gui_step</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">col0</span> <span class="o">=</span> <span class="n">column</span><span class="p">([</span><span class="n">gui_N_LS</span><span class="p">,</span> <span class="n">gui_x_H</span><span class="p">,</span> <span class="n">gui_y_H</span><span class="p">,</span> <span class="n">empty_s</span><span class="p">,</span> <span class="n">strich1</span><span class="p">,</span> \
                       <span class="n">gui_ref_array</span><span class="p">,</span> <span class="n">gui_ref_discrete_angles</span><span class="p">,</span> \
                       <span class="n">gui_ref_userdef</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="n">col1</span> <span class="o">=</span> <span class="n">column</span><span class="p">([</span><span class="n">gui_Lambda_gap</span><span class="p">,</span> <span class="n">gui_use_dangles</span><span class="p">,</span> <span class="n">gui_discrete_angles</span><span class="p">,</span> \
                       <span class="n">config_error_info</span><span class="p">,</span> <span class="n">strich6</span><span class="p">,</span> <span class="n">gui_ref_start</span><span class="p">,</span> \
                       <span class="n">gui_ref_step_stop</span><span class="p">,</span> <span class="n">ref_arr_table</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="n">col2</span> <span class="o">=</span> <span class="n">column</span><span class="p">([</span><span class="n">row</span><span class="p">([</span><span class="n">p_equal_axis_dist</span><span class="p">,</span> <span class="n">p_equal_axis</span><span class="p">]),</span> <span class="n">p</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">690</span><span class="p">)</span>
        <span class="n">row0</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">column</span><span class="p">(</span><span class="n">aklogo</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="n">tublogo</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">170</span><span class="p">),</span> \
                    <span class="n">column</span><span class="p">(</span><span class="n">aklogo2</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="n">gui_step</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">690</span><span class="p">)])</span>
        <span class="n">row1</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">headline</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">1230</span><span class="p">)</span>
        <span class="n">row2</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">col0</span><span class="p">,</span> <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">])</span>
        <span class="n">figall</span> <span class="o">=</span> <span class="n">gridplot</span><span class="p">([[</span><span class="n">row0</span><span class="p">],[</span><span class="n">row1</span><span class="p">],[</span><span class="n">row2</span><span class="p">]],</span> <span class="n">toolbar_location</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> \
                          <span class="n">merge_tools</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">curdoc</span><span class="p">()</span><span class="o">.</span><span class="n">add_root</span><span class="p">(</span><span class="n">figall</span><span class="p">)</span>
              
    <span class="k">elif</span> <span class="n">gui_step</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">col0</span> <span class="o">=</span> <span class="n">column</span><span class="p">([</span><span class="n">gui_PALC_alg</span><span class="p">,</span> <span class="n">gui_gap_handling</span><span class="p">,</span> <span class="n">gui_strength_smarg</span><span class="p">,</span> \
                       <span class="n">strich5</span><span class="p">,</span> <span class="n">row</span><span class="p">([</span><span class="n">gui_weighting</span><span class="p">,</span> <span class="n">gui_opt_weight_link</span><span class="p">]),</span> <span class="n">gui_weighting_nu</span><span class="p">,</span> <span class="n">weighting_title</span><span class="p">,</span> \
                       <span class="n">row</span><span class="p">([</span><span class="n">weighting_plus</span><span class="p">,</span> <span class="n">weighting_minus</span><span class="p">,</span> <span class="n">weighting_step_size</span><span class="p">]),</span> \
                       <span class="n">strich6</span><span class="p">,</span> <span class="n">gui_tolerance</span><span class="p">,</span> <span class="n">gui_use_fixed_angles</span><span class="p">,</span> \
                       <span class="n">gui_fixed_first_angle</span><span class="p">,</span> <span class="n">fixed_angle_text</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="n">col1</span> <span class="o">=</span> <span class="n">column</span><span class="p">([</span><span class="n">check_PAL_button</span><span class="p">,</span> <span class="n">gui_start</span><span class="p">,</span> <span class="n">gui_clear_result_fig</span><span class="p">,</span> \
                       <span class="n">gui_download_result</span><span class="p">,</span> <span class="n">config_error_info</span><span class="p">,</span> <span class="n">results_table</span><span class="p">,</span> <span class="n">gui_download_SPLoverX</span><span class="p">],</span> \
                      <span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="n">col2</span> <span class="o">=</span> <span class="n">column</span><span class="p">([</span><span class="n">row</span><span class="p">([</span><span class="n">p_equal_axis_dist</span><span class="p">,</span> <span class="n">p_equal_axis</span><span class="p">]),</span> <span class="n">SPLoverX_tabs</span><span class="p">],</span> \
                      <span class="n">width</span><span class="o">=</span><span class="mi">690</span><span class="p">)</span>
        <span class="n">row0</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">column</span><span class="p">(</span><span class="n">aklogo</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="n">tublogo</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">170</span><span class="p">),</span> \
                    <span class="n">column</span><span class="p">(</span><span class="n">aklogo2</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="n">gui_step</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">690</span><span class="p">)])</span>
        <span class="n">row1</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">headline</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">1230</span><span class="p">)</span>
        <span class="n">row2</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">col0</span><span class="p">,</span> <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">])</span>
        <span class="n">figall</span> <span class="o">=</span> <span class="n">gridplot</span><span class="p">([[</span><span class="n">row0</span><span class="p">],[</span><span class="n">row1</span><span class="p">],[</span><span class="n">row2</span><span class="p">]],</span> <span class="n">toolbar_location</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> \
                          <span class="n">merge_tools</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">curdoc</span><span class="p">()</span><span class="o">.</span><span class="n">add_root</span><span class="p">(</span><span class="n">figall</span><span class="p">)</span>
        
    <span class="k">elif</span> <span class="n">gui_step</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">row0</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">column</span><span class="p">(</span><span class="n">aklogo</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="n">tublogo</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">170</span><span class="p">),</span> \
                    <span class="n">column</span><span class="p">(</span><span class="n">aklogo2</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="n">gui_step</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">690</span><span class="p">)])</span>
        <span class="n">row1</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">headline</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">1230</span><span class="p">)</span>
        <span class="n">row2</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">res_tabs</span><span class="p">])</span>
        <span class="n">figall</span> <span class="o">=</span> <span class="n">gridplot</span><span class="p">([[</span><span class="n">row0</span><span class="p">],[</span><span class="n">row1</span><span class="p">],[</span><span class="n">row2</span><span class="p">]],</span> <span class="n">toolbar_location</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> \
                          <span class="n">merge_tools</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">curdoc</span><span class="p">()</span><span class="o">.</span><span class="n">add_root</span><span class="p">(</span><span class="n">figall</span><span class="p">)</span></div>
        

        
<span class="c1">#%%##################### WIDGETS ##############################################</span>
<span class="c1"># PAGE 0: General Information and Help</span>
<span class="n">help_tabs</span> <span class="o">=</span> <span class="n">help_text</span><span class="p">()</span>

<span class="c1"># PAGE 1: Draw The Polygonal Audience Line</span>
<span class="n">start_point_x</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> \
                          <span class="n">title</span><span class="o">=</span><span class="s2">&quot;1. Start Position (x) of Audience Line in m&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextInput widget of start point of audience lines in x-direction. Triggers </span>
<span class="sd">   :any:`update_point`.&quot;&quot;&quot;</span>
<span class="n">start_point_y</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> \
                          <span class="n">title</span><span class="o">=</span><span class="s2">&quot;4. Start Position (y) of Audience Line in m&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextInput widget of start point of audience lines in y-direction. Triggers</span>
<span class="sd">   :any:`update_point`.&quot;&quot;&quot;</span>
<span class="n">end_point_x</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> \
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;2. End Position (x) of Audience Line in m&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextInput widget of end point of audience lines in x-direction. Triggers</span>
<span class="sd">   :any:`update_point`.&quot;&quot;&quot;</span>
<span class="n">end_point_y</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> \
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;5. End Position (y) of Audience Line in m&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextInput widget of end point of audience lines in y-direction. Triggers</span>
<span class="sd">   :any:`update_point`.&quot;&quot;&quot;</span>
<span class="n">line_discretization</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> \
                                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;3. Discretization: Number of Points per m&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextInput widget to define the discretization in points per m of audience lines&quot;&quot;&quot;</span>
<span class="n">save_line_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;6. Save Current Audience Line&quot;</span><span class="p">,</span> \
                          <span class="n">button_type</span><span class="o">=</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Button widget to save audience lines. Triggers :any:`save_line`&quot;&quot;&quot;</span>
<span class="n">remove_line_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;7. Remove Last Audience Line&quot;</span><span class="p">,</span> \
                            <span class="n">button_type</span><span class="o">=</span><span class="s2">&quot;danger&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Button widget to remove audience lines. Triggers :any:`remove_line`&quot;&quot;&quot;</span>
<span class="n">save_prev_line_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;6. Add Line before Selected Line&quot;</span><span class="p">,</span> \
                               <span class="n">button_type</span><span class="o">=</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Button widget to save a audience line before the selected line. Triggers</span>
<span class="sd">   :any:`create_prev_line`&quot;&quot;&quot;</span>
<span class="n">remove_sel_line_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;7. Remove Selected Audience Line&quot;</span><span class="p">,</span> \
                                <span class="n">button_type</span><span class="o">=</span><span class="s2">&quot;danger&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Button widget to remove a audience line in front of the selected line. Triggers</span>
<span class="sd">   :any:`remove_sel_line`&quot;&quot;&quot;</span>
<span class="n">check_PAL_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;8. Get PALC Venue Proposal&quot;</span><span class="p">,</span> \
                          <span class="n">button_type</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Button widget to check the created venue slice. Triggers :any:`check_PAL`&quot;&quot;&quot;</span>

<span class="c1"># PAGE 2: Loudspeaker Configuration</span>
<span class="n">gui_psi_n</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;3.0&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;9. PALC Aperture Angle in deg&quot;</span><span class="p">,</span> \
                      <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextInput widget to define the initial splay / aperture angle of the LSA</span>
<span class="sd">   cabinets. Triggers :any:`get_value`.&quot;&quot;&quot;</span>
<span class="n">gui_Lambda_y</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;0.2&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;10. Loudspeaker Height in m&quot;</span><span class="p">,</span> \
                         <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextInput widget to define the height of the used LSA cabinets. Triggers</span>
<span class="sd">   :any:`get_value`.&quot;&quot;&quot;</span>
<span class="n">gui_directivity</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;11. Loudspeaker Directivity&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Circular Piston&quot;</span><span class="p">,</span> \
                         <span class="n">options</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;Circular Piston&quot;</span><span class="p">,</span><span class="s2">&quot;Modeled: Circular Piston&quot;</span><span class="p">),</span> \
                                  <span class="p">(</span><span class="s2">&quot;Line Piston&quot;</span><span class="p">,</span><span class="s2">&quot;Modeled: Line Piston&quot;</span><span class="p">),</span> \
                                  <span class="p">(</span><span class="s2">&quot;Combined Circular/Line&quot;</span><span class="p">,</span> <span class="s2">&quot;Modeled: Combined Circular/Line&quot;</span><span class="p">),</span> \
                                  <span class="s2">&quot;Measured Loudspeaker Data&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Select widget to choose a directivity of the LSA cabinets used in the Sound</span>
<span class="sd">   Field Prediction. Can be either Circular Piston, Line Piston, Comined Circular</span>
<span class="sd">   and Line Piston (x-over at 1.5 kHz) or Measured Loudspeaker Data. Triggers</span>
<span class="sd">   :any:`get_value`.&quot;&quot;&quot;</span>
<span class="n">button_input</span> <span class="o">=</span> <span class="n">FileInput</span><span class="p">(</span><span class="n">accept</span><span class="o">=</span><span class="s2">&quot;.csv&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;FileInput widget to upload measured (complex) directivity data. Triggers</span>
<span class="sd">   :any:`upload_directivity`.&quot;&quot;&quot;</span>

<span class="c1"># PAGE 3: Array Configuration</span>
<span class="n">gui_N_LS</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;12. Number of Loudspeaker Cabinets&quot;</span><span class="p">,</span> \
                     <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextInput widget to enter the number of LS cabinets in LSA. Triggers</span>
<span class="sd">   :any:`get_value`.&quot;&quot;&quot;</span>
<span class="n">gui_x_H</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;13. Uppermost Cabinet: x in m&quot;</span><span class="p">,</span> \
                    <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextInput widget to enter the mounting point in x-direction (front position</span>
<span class="sd">   of the heighest LS cabinet. Triggers :any:`get_value`.&quot;&quot;&quot;</span>
<span class="n">gui_y_H</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;14. Uppermost Cabinet: y in m&quot;</span><span class="p">,</span> \
                    <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextInput widget to enter the mounting height of the LSA (top front of the</span>
<span class="sd">   highest LS cabinet. Triggers :any:`get_value`&quot;&quot;&quot;</span>
<span class="n">gui_Lambda_gap</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;15. Gap between Cabinets in m&quot;</span><span class="p">,</span> \
                           <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextInput to define gaps between the LS cabinets. Triggers :any:`get_value`&quot;&quot;&quot;</span>
<span class="n">gui_use_dangles</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;16. Use Discrete Tilt Angles?&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;No&quot;</span><span class="p">,</span> \
                         <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No&quot;</span><span class="p">,</span> <span class="s2">&quot;Yes&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Select widget to choose if discrete tilt angles shall be used. Triggers</span>
<span class="sd">   :any:`choose_dangles`.&quot;&quot;&quot;</span>
<span class="n">gui_discrete_angles</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> \
                                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;17. Discrete Tilt Angles in deg (&#39;,&#39;: separator)&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextInput widget to enter the discrete tilt angles. Triggers :any:`get_discrete_angles`.&quot;&quot;&quot;</span>
<span class="n">gui_ref_array</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Reference Array: Type&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Straight&quot;</span><span class="p">,</span> \
                       <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Straight&quot;</span><span class="p">,</span> <span class="s2">&quot;Progressive&quot;</span><span class="p">,</span> <span class="s2">&quot;Arc&quot;</span><span class="p">,</span> <span class="s2">&quot;User Defined&quot;</span><span class="p">],</span> \
                           <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Select widget to choose the type of the reference LSA. Triggers</span>
<span class="sd">   :any:`reference_array_setting`&quot;&quot;&quot;</span>
<span class="n">gui_ref_discrete_angles</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Reference Array: Use Angles of (17.)?&quot;</span><span class="p">,</span> \
                                 <span class="n">value</span><span class="o">=</span><span class="s2">&quot;No&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Yes&quot;</span><span class="p">,</span> <span class="s2">&quot;No&quot;</span><span class="p">],</span> \
                                 <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Select widget to choose if discrete tilt angles of :any:`gui_discrete_angles`</span>
<span class="sd">   shall be used. Triggers :any:`get_ref_array_angles`.&quot;&quot;&quot;</span>
<span class="n">gui_ref_start</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> \
                          <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Reference Array: Array Tilt Angle in deg&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextInput widget to enter the angle of the heighest LSA cabinet in reference</span>
<span class="sd">   array.  Triggers :any:`get_ref_array_angles`.&quot;&quot;&quot;</span>
<span class="n">gui_ref_step_stop</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> \
                              <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Reference Array: Inter Cabinet Angle in deg&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextInput widget to enter the inter cabinet angle of the reference array.</span>
<span class="sd">   Triggers :any:`get_ref_array_angles`.&quot;&quot;&quot;</span>
<span class="n">gui_ref_userdef</span> <span class="o">=</span> <span class="n">TextAreaInput</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> \
                                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;User Defined Tilt Angles in deg (&#39;,&#39;: separator)&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextAreaInput widget to enter user defined tilt angles of the reference array.</span>
<span class="sd">   Triggers :any:`get_ref_array_angles`.&quot;&quot;&quot;</span>

<span class="c1"># PAGE 4: Algorithm Selection and Start Calculation</span>
<span class="n">gui_PALC_alg</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;18. PALC-Algorithm&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;PALC 2&quot;</span><span class="p">,</span> \
                      <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PALC 1&quot;</span><span class="p">,</span> <span class="s2">&quot;PALC 2&quot;</span><span class="p">,</span> <span class="s2">&quot;PALC 3&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Select widget to choose the type of the algorithm. Either PALC1 (Splay angles</span>
<span class="sd">   are equal), PALC2 (Splay angles depend on distance to receiver), PALC3</span>
<span class="sd">   Similar to PALC2, tan of splay angles is used). Triggers :any:`get_value`.&quot;&quot;&quot;</span>    
<span class="n">gui_gap_handling</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;19. Gap Handling Approach&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Without&quot;</span><span class="p">,</span> \
                          <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Without&quot;</span><span class="p">,</span> <span class="s2">&quot;Hard Margin&quot;</span><span class="p">,</span> <span class="s2">&quot;Soft Margin&quot;</span><span class="p">],</span> \
                          <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Select widget to choose the gap handling approach. Either Without (No gap</span>
<span class="sd">   handling), Hard Margin (based on assumed splay angles, gaps are totally avoided),</span>
<span class="sd">   Soft Margin (gaps are lower weighted). Triggers :any:`get_value`.&quot;&quot;&quot;</span>
<span class="n">gui_strength_smarg</span> <span class="o">=</span> <span class="n">Slider</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;20. Strength of Soft Margin&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> \
                            <span class="n">start</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mf">1.9</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Slider widget to set the strength of soft margin approach, if chosen in </span>
<span class="sd">   :any:`gui_gap_handling`. Triggers :any:`get_value`.&quot;&quot;&quot;</span>
<span class="n">gui_weighting</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;21. Weighting&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Without&quot;</span><span class="p">,</span> \
                       <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Without&quot;</span><span class="p">,</span> <span class="s2">&quot;Linear Spacing&quot;</span><span class="p">,</span> <span class="s2">&quot;Logarithmic Spacing&quot;</span><span class="p">,</span> <span class="s2">&quot;Target Slope&quot;</span><span class="p">],</span> \
                       <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Select widget to choose the weighting approach. Triggers :any:`weighting_select`.&quot;&quot;&quot;</span>
<span class="n">gui_opt_weight_link</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Hinges in Target&quot;</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> \
                             <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">105</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Select widget to choose number of hinges in target slope when &#39;Target Slope&#39;</span>
<span class="sd">   is chosen in :any:`gui_weighting`. The number of choosable hinges depends on</span>
<span class="sd">   the number of audience lines.&quot;&quot;&quot;</span>
<span class="c1"># cubic spaced slider: when used, function store_weighting_nu must be adapted (input with the power of 3)</span>
<span class="n">gui_weighting_nu</span> <span class="o">=</span> <span class="n">Slider</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Weighting Parameter &quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cbrt</span><span class="p">(</span><span class="mf">1.00</span><span class="p">),</span> \
                          <span class="n">start</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cbrt</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cbrt</span><span class="p">(</span><span class="mf">10.00</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> \
                          <span class="nb">format</span><span class="o">=</span><span class="n">FuncTickFormatter</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="s2">&quot;return Math.pow(tick,3).toFixed(2)&quot;</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot;Slider widget to set the strength of the weighting if &#39;Linear Spacing&#39; or</span>
<span class="sd">   &#39;Logarithmic Spacing&#39; is chosen in :any:`gui_weighting`. Triggers</span>
<span class="sd">   :any:`store_weighting_nu`.&quot;&quot;&quot;</span>
<span class="c1"># linear spaced slider of the weighting</span>
<span class="c1"># gui_weighting_nu = Slider(title=&quot;Weighting Parameter &quot;, value=1.00, \</span>
<span class="c1">#                           start=0.01, end=10.00, step=0.01, disabled=True, width=255)</span>
<span class="n">weighting_title</span> <span class="o">=</span> <span class="n">Paragraph</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;22. Adjustment of  and Step Size&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">weighting_plus</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="n">button_type</span><span class="o">=</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Button widget that increases the weightings strength by the value of</span>
<span class="sd">   :any:`weighting_step_size`.&quot;&quot;&quot;</span>
<span class="n">weighting_minus</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">button_type</span><span class="o">=</span><span class="s2">&quot;danger&quot;</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Button widget that decreases the weightings strength by the value of</span>
<span class="sd">   :any:`weighting_step_size`.&quot;&quot;&quot;</span>
<span class="n">weighting_step_size</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;0.05&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0.01&#39;</span><span class="p">,</span> <span class="s1">&#39;0.05&#39;</span><span class="p">,</span> <span class="s1">&#39;0.10&#39;</span><span class="p">,</span> <span class="s1">&#39;0.50&#39;</span><span class="p">],</span> \
                             <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Select widget to set the step size of :any:`weighting_plus` and</span>
<span class="sd">   :any:`weighting_minus`. Triggers :any:`update_weighting_step_size`.&quot;&quot;&quot;</span>
<span class="n">gui_tolerance</span> <span class="o">=</span> <span class="n">Slider</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;23. Tolerance (Abort Criterion) in m&quot;</span><span class="p">,</span> \
                       <span class="n">value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Slider widget to set the tolerance, which is the break out condition of the</span>
<span class="sd">   PALC computation. It is the distance of covered region to the first audience</span>
<span class="sd">   position in m. Triggers :any:`get_value`.&quot;&quot;&quot;</span>
<span class="n">gui_use_fixed_angles</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;24. Fix Angle of Uppermost Cabinet?&quot;</span><span class="p">,</span> \
                              <span class="n">value</span><span class="o">=</span><span class="s2">&quot;No&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No&quot;</span><span class="p">,</span> <span class="s2">&quot;Yes&quot;</span><span class="p">],</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> \
                                  <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Select widget to choose if the heighest LSA cabinet shall be fixed on a</span>
<span class="sd">   specific angle.&quot;&quot;&quot;</span>
<span class="n">gui_fixed_first_angle</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;25. Angle of Uppermost Cabinet in deg&quot;</span><span class="p">,</span> \
                                  <span class="n">value</span><span class="o">=</span><span class="s2">&quot;0.0&quot;</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;TextInput widget to enter the fixed angle of the heighest LSA cabinet.</span>
<span class="sd">   Triggers :any:`get_value`.&quot;&quot;&quot;</span>
<span class="n">fixed_angle_text</span> <span class="o">=</span> <span class="n">Paragraph</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Max: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Opt_arr</span><span class="o">.</span><span class="n">fixed_angle</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;, Min: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Opt_arr</span><span class="o">.</span><span class="n">fixed_angle</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

<span class="n">gui_start</span> <span class="o">=</span> <span class="n">Toggle</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;26. PALC Run&quot;</span><span class="p">,</span> <span class="n">button_type</span><span class="o">=</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> \
                   <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Toggle widget to start the PALC and SFP computation.&quot;&quot;&quot;</span>
<span class="n">gui_clear_result_fig</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;27. Delete Result Visualization&quot;</span><span class="p">,</span> \
                              <span class="n">button_type</span><span class="o">=</span><span class="s2">&quot;danger&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Button widget to clear the plotted venue slice with LSA and rays. Triggers</span>
<span class="sd">   :any:`clear_result_fig`&quot;&quot;&quot;</span>
<span class="n">gui_download_result</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Download PALC Angles&quot;</span><span class="p">,</span> <span class="n">button_type</span><span class="o">=</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Button widget to download the PALC tilt angles in .csv format&quot;&quot;&quot;</span>
<span class="n">gui_freq_range</span> <span class="o">=</span> <span class="n">RangeSlider</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Frequency Range&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">690</span><span class="p">,</span> \
                             <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">8000</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">gui_download_SPLoverX</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Download SPL&quot;</span><span class="p">,</span> <span class="n">button_type</span><span class="o">=</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>

<span class="c1"># PAGE 5: Results Visualization</span>
<span class="n">gui_f_beam</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Frequency in Hz&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;63&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> \
                    <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;63&quot;</span><span class="p">,</span> <span class="s2">&quot;125&quot;</span><span class="p">,</span> <span class="s2">&quot;250&quot;</span><span class="p">,</span> <span class="s2">&quot;500&quot;</span><span class="p">,</span> <span class="s2">&quot;1000&quot;</span><span class="p">,</span> <span class="s2">&quot;2000&quot;</span><span class="p">,</span> <span class="s2">&quot;4000&quot;</span><span class="p">,</span> <span class="s2">&quot;8000&quot;</span><span class="p">,</span> <span class="s2">&quot;16000&quot;</span><span class="p">])</span>
<span class="sd">&quot;&quot;&quot;Select widget to choose the plotted frequency in the beamplot. Triggers</span>
<span class="sd">   :any:`get_beamplot`.&quot;&quot;&quot;</span>
<span class="n">gui_which_beam</span> <span class="o">=</span> <span class="n">CheckboxGroup</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PALC&quot;</span><span class="p">,</span> <span class="s2">&quot;Reference&quot;</span><span class="p">],</span> <span class="n">active</span><span class="o">=</span><span class="p">[],</span> \
                               <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> \
                               <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;CheckboxGroup widget to choose wheter PALC and/or Reference results shall</span>
<span class="sd">   be shown as a beamplot. Triggers :any:`get_beamplot`.&quot;&quot;&quot;</span>

<span class="c1"># HEADER and GENERAL: AK Logo, RadioGroup steps, errors and warnings, etc.</span>
<span class="c1"># AK Logo</span>
<span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="n">aklogo</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">x_range</span><span class="o">=</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="o">=</span><span class="n">y_range</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">plot_height</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">min_border</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">aklogo</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span><span class="p">,</span> <span class="n">aklogo</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">visible</span>        <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="kc">False</span>
<span class="n">aklogo</span><span class="o">.</span><span class="n">outline_line_color</span><span class="p">,</span> <span class="n">aklogo</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">False</span>
<span class="n">aklogo</span><span class="o">.</span><span class="n">toolbar_location</span><span class="p">,</span> <span class="n">aklogo</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;grey&#39;</span>
<span class="n">IMPATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">appname</span><span class="si">}</span><span class="s2">/static/logo_grau-schwarz.png&quot;</span><span class="p">)</span>
<span class="n">aklogo</span><span class="o">.</span><span class="n">image_url</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="p">[</span><span class="n">IMPATH</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> \
                 <span class="n">w</span><span class="o">=</span><span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">h</span><span class="o">=</span><span class="n">y_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">y_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.6</span><span class="p">))</span>
<span class="n">aklogo2</span> <span class="o">=</span> <span class="n">Div</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;&lt;b&gt;A Software Tool by the &lt;br&gt;&lt;big&gt;&lt;a href=&quot;https://www.ak.tu-berlin.de&quot; target=&quot;_blank&quot;&gt;Audio Communication Group&lt;/a&gt;&lt;/big&gt;&lt;/b&gt;&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">tublogo</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">x_range</span><span class="o">=</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="o">=</span><span class="n">y_range</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">80</span><span class="o">*</span><span class="mf">1.786</span><span class="p">),</span> \
                 <span class="n">plot_height</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">min_border</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">tublogo</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span><span class="p">,</span> <span class="n">tublogo</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">visible</span>        <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="kc">False</span>
<span class="n">tublogo</span><span class="o">.</span><span class="n">outline_line_color</span><span class="p">,</span> <span class="n">tublogo</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">False</span>
<span class="n">tublogo</span><span class="o">.</span><span class="n">toolbar_location</span><span class="p">,</span> <span class="n">tublogo</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;grey&#39;</span>
<span class="n">IMPATHtub</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">appname</span><span class="si">}</span><span class="s2">/static/TUB.png&quot;</span><span class="p">)</span>
<span class="n">tublogo</span><span class="o">.</span><span class="n">image_url</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="p">[</span><span class="n">IMPATHtub</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> \
                  <span class="n">w</span><span class="o">=</span><span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">h</span><span class="o">=</span><span class="n">y_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">y_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.6</span><span class="p">))</span>
<span class="n">gui_step</span> <span class="o">=</span> <span class="n">RadioButtonGroup</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Help&quot;</span><span class="p">,</span><span class="s2">&quot;1. PAL&quot;</span><span class="p">,</span> <span class="s2">&quot;2. Loudspeaker Configuration&quot;</span><span class="p">,</span> \
                                    <span class="s2">&quot;3. Array Configuration&quot;</span><span class="p">,</span> <span class="s2">&quot;4. Algorithm&quot;</span><span class="p">,</span> \
                                    <span class="s2">&quot;5. Sound Field Prediction&quot;</span><span class="p">],</span> \
                            <span class="n">active</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">button_type</span><span class="o">=</span><span class="s2">&quot;primary&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">680</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;RadioButtonGroup widget to switch between the different pages.&quot;&quot;&quot;</span>
<span class="n">p_equal_axis</span> <span class="o">=</span> <span class="n">RadioGroup</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Equal (variable figure height)&#39;</span><span class="p">,</span> \
                                  <span class="s1">&#39;Equal (const. figure height)&#39;</span><span class="p">,</span> <span class="s1">&#39;Stretched&#39;</span><span class="p">],</span> \
                          <span class="n">active</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> \
                          <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;RadioGroup widget to set the scaling of the venue slice plot. Triggers</span>
<span class="sd">   :any:`scale_p_axis`.&quot;&quot;&quot;</span>
<span class="n">p_equal_axis_dist</span> <span class="o">=</span> <span class="n">Div</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;      &lt;b&gt; Venue Slice Axes: &lt;/b&gt;&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">p_which_beamplot</span> <span class="o">=</span> <span class="n">Div</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;      &lt;b&gt; Beam Plot of: &lt;/b&gt;&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>

<span class="n">pal_error_info</span> <span class="o">=</span> <span class="n">Div</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">config_error_info</span> <span class="o">=</span> <span class="n">Paragraph</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">strich1</span> <span class="o">=</span> <span class="n">Paragraph</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;______________________________________&quot;</span><span class="p">)</span>
<span class="n">strich5</span> <span class="o">=</span> <span class="n">Paragraph</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;___________________________________&quot;</span><span class="p">)</span>
<span class="n">strich6</span> <span class="o">=</span> <span class="n">Paragraph</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;___________________________________&quot;</span><span class="p">)</span>
<span class="n">headline</span> <span class="o">=</span> <span class="n">Paragraph</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;_____________________________________________________________________________________________________________________________________________________________________________&quot;</span><span class="p">)</span>
<span class="c1">#strichSFP = Paragraph(text=&quot;________________________________________________________________________________________________________________________________________________________________________________________&quot;)</span>
<span class="n">empty_s</span>   <span class="o">=</span> <span class="n">Paragraph</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">yAchse</span> <span class="o">=</span> <span class="n">Div</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;&lt;b&gt;y-Axis&lt;/b&gt;&quot;</span><span class="p">)</span>
<span class="n">xAchse</span> <span class="o">=</span> <span class="n">Div</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;&lt;b&gt;x-Axis&lt;/b&gt;&quot;</span><span class="p">)</span>

<span class="c1">#%%######### Callbacks of the Widgets #########################################</span>
<span class="c1"># PAGE 1: Draw The Polygonal Audience Line</span>
<span class="n">start_point_x</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">update_point</span><span class="p">)</span>
<span class="n">start_point_y</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">update_point</span><span class="p">)</span>
<span class="n">end_point_x</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">update_point</span><span class="p">)</span>
<span class="n">end_point_y</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">update_point</span><span class="p">)</span>
<span class="n">save_line_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">save_line</span><span class="p">)</span>
<span class="n">remove_line_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">remove_line</span><span class="p">)</span>
<span class="n">save_prev_line_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">create_prev_line</span><span class="p">)</span>
<span class="n">remove_sel_line_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">remove_sel_line</span><span class="p">)</span>
<span class="n">check_PAL_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">check_PAL</span><span class="p">)</span>

<span class="c1"># PAGE 2: Loudspeaker Configuration</span>
<span class="n">gui_psi_n</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">get_value</span><span class="p">)</span>
<span class="n">gui_Lambda_y</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">get_value</span><span class="p">)</span>
<span class="n">gui_directivity</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">get_value</span><span class="p">)</span>
<span class="n">button_input</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">upload_directivity</span><span class="p">)</span>

<span class="c1"># PAGE 3: Array Configuration</span>
<span class="n">gui_x_H</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">get_value</span><span class="p">)</span>
<span class="n">gui_y_H</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">get_value</span><span class="p">)</span>
<span class="n">gui_N_LS</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">get_value</span><span class="p">)</span>
<span class="n">gui_Lambda_gap</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">get_value</span><span class="p">)</span>
<span class="n">gui_use_dangles</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">choose_dangles</span><span class="p">)</span>
<span class="n">gui_discrete_angles</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">get_discrete_angles</span><span class="p">)</span>
<span class="n">gui_discrete_angles</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">:</span> <span class="n">get_ref_array_angles</span><span class="p">())</span>
<span class="n">gui_ref_array</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">reference_array_setting</span><span class="p">)</span>
<span class="n">gui_ref_start</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">:</span> <span class="n">get_ref_array_angles</span><span class="p">())</span>
<span class="n">gui_ref_step_stop</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">:</span> <span class="n">get_ref_array_angles</span><span class="p">())</span>
<span class="n">gui_ref_discrete_angles</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">:</span> <span class="n">get_ref_array_angles</span><span class="p">())</span>
<span class="n">gui_ref_userdef</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">:</span> <span class="n">get_ref_array_angles</span><span class="p">())</span>

<span class="c1"># PAGE 4: Algorithm Selection and Start Calculation</span>
<span class="n">gui_PALC_alg</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">get_value</span><span class="p">)</span>
<span class="n">gui_gap_handling</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">get_value</span><span class="p">)</span>
<span class="n">gui_strength_smarg</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">get_value</span><span class="p">)</span>
<span class="n">gui_weighting</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">weighting_select</span><span class="p">)</span>
<span class="n">gui_opt_weight_link</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">chg_weight_links</span><span class="p">)</span>
<span class="n">gui_weighting_nu</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">store_weighting_nu</span><span class="p">)</span>
<span class="n">weighting_plus</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">adjust_weighting_plus</span><span class="p">)</span>
<span class="n">weighting_minus</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">adjust_weighting_minus</span><span class="p">)</span>
<span class="n">weighting_step_size</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">update_weighting_step_size</span><span class="p">)</span>
<span class="n">gui_tolerance</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">get_value</span><span class="p">)</span>
<span class="n">gui_use_fixed_angles</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">use_fixed_angle</span><span class="p">)</span>
<span class="n">gui_fixed_first_angle</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">get_value</span><span class="p">)</span>
<span class="n">gui_start</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">start_calc</span><span class="p">)</span>
<span class="n">gui_clear_result_fig</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">clear_result_fig</span><span class="p">)</span>
<span class="n">Opt_SPLoverX_dict</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">update_draw</span><span class="p">)</span>
<span class="n">Opt_refpoint_dict</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">update_draw</span><span class="p">)</span>
<span class="n">gui_download_result</span><span class="o">.</span><span class="n">js_on_click</span><span class="p">(</span><span class="n">CustomJS</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">results_dict</span><span class="p">),</span> \
                            <span class="n">code</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> \
                                                   <span class="s2">&quot;ext/download.js&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>
<span class="n">gui_freq_range</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">get_value</span><span class="p">)</span>
<span class="n">gui_download_SPLoverX</span><span class="o">.</span><span class="n">js_on_click</span><span class="p">(</span><span class="n">CustomJS</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">SPLoverX_dict</span><span class="p">),</span> \
                            <span class="n">code</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> \
                                                   <span class="s2">&quot;ext/download.js&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>
<span class="n">gui_download_SPLoverX</span><span class="o">.</span><span class="n">js_on_click</span><span class="p">(</span><span class="n">CustomJS</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">Opt_SPLoverX_dict</span><span class="p">),</span> \
                            <span class="n">code</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> \
                                                   <span class="s2">&quot;ext/download.js&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>
<span class="n">gui_download_SPLoverX</span><span class="o">.</span><span class="n">js_on_click</span><span class="p">(</span><span class="n">CustomJS</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">Opt_refpoint_dict</span><span class="p">),</span> \
                            <span class="n">code</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> \
                                                   <span class="s2">&quot;ext/download.js&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>
<span class="n">gui_download_SPLoverX</span><span class="o">.</span><span class="n">js_on_click</span><span class="p">(</span><span class="n">CustomJS</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">SPLoverX_ref_dict</span><span class="p">),</span> \
                            <span class="n">code</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> \
                                                   <span class="s2">&quot;ext/download.js&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>
<span class="n">gui_download_SPLoverX</span><span class="o">.</span><span class="n">js_on_click</span><span class="p">(</span><span class="n">CustomJS</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">Homogeneity_dict</span><span class="p">),</span> \
                            <span class="n">code</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> \
                                                   <span class="s2">&quot;ext/download.js&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>

<span class="c1"># PAGE 5: Results Visualization</span>
<span class="n">gui_f_beam</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">get_beamplot</span><span class="p">)</span>
<span class="n">gui_which_beam</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s2">&quot;active&quot;</span><span class="p">,</span> <span class="n">get_beamplot</span><span class="p">)</span>

<span class="c1"># HEADER: Switch between the Pages</span>
<span class="n">gui_step</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">:</span> <span class="n">steps</span><span class="p">())</span>
<span class="n">p_equal_axis</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">attr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">:</span> <span class="n">scale_p_axis</span><span class="p">())</span>


<span class="c1">#%%################### PLOTTING ###############################################</span>
<span class="c1"># frequency axis ticker</span>
<span class="n">f_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">]</span>
<span class="n">f_ticks_override</span> <span class="o">=</span> <span class="p">{</span><span class="mi">20</span><span class="p">:</span> <span class="s1">&#39;0.02&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">:</span> <span class="s1">&#39;0.05&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">:</span> <span class="s1">&#39;0.1&#39;</span><span class="p">,</span> <span class="mi">200</span><span class="p">:</span> <span class="s1">&#39;0.2&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">:</span> <span class="s1">&#39;0.5&#39;</span><span class="p">,</span> \
                    <span class="mi">1000</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">:</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="mi">10000</span><span class="p">:</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="mi">20000</span><span class="p">:</span> <span class="s1">&#39;20&#39;</span><span class="p">}</span>
<span class="c1">###### Venue Slice: p (PAGE 1,2,3,4) ######</span>
<span class="n">ptools</span> <span class="o">=</span> <span class="s2">&quot;box_zoom,pan,wheel_zoom,reset,tap,hover,save&quot;</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">x_axis_label</span><span class="o">=</span><span class="s2">&quot;x in m&quot;</span><span class="p">,</span> <span class="n">y_axis_label</span><span class="o">=</span><span class="s2">&quot;y in m&quot;</span><span class="p">,</span> \
           <span class="n">toolbar_sticky</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">toolbar_location</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="n">ptools</span><span class="p">,</span> \
           <span class="n">frame_height</span><span class="o">=</span><span class="mi">478</span><span class="p">,</span> <span class="n">frame_width</span><span class="o">=</span><span class="mi">637</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Venue Slice Plot&quot;&quot;&quot;</span>
<span class="n">p</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1"># Venue Slice</span>
<span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label_text_font_style</span> <span class="o">=</span> <span class="s2">&quot;normal&quot;</span>
<span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label_text_font_style</span> <span class="o">=</span> <span class="s2">&quot;normal&quot;</span>
<span class="c1">#p.x(2,2, color=&#39;#323030&#39;)</span>
<span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">guipal</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;lightskyblue&quot;</span><span class="p">)</span> <span class="c1">#blue </span>
<span class="n">pal_line</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="s1">&#39;xlineplt&#39;</span><span class="p">,</span> <span class="s1">&#39;ylineplt&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">guilineplt</span><span class="p">,</span> \
                        <span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;PALC and SFP&#39;</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> \
                        <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;lightskyblue&quot;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> \
                        <span class="n">selection_color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">,</span> <span class="n">nonselection_line_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="c1">#lightskyblue</span>
<span class="n">nal_line</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="s1">&#39;xnalplt&#39;</span><span class="p">,</span> <span class="s1">&#39;ynalplt&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">guinalplt</span><span class="p">,</span> \
                        <span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;PALC (non-audience line)&#39;</span><span class="p">,</span> \
                        <span class="n">line_dash</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;lime&quot;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> \
                        <span class="n">nonselection_line_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># firebrick, lime</span>
<span class="n">sfp_line</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="s1">&#39;xsfpplt&#39;</span><span class="p">,</span> <span class="s1">&#39;ysfpplt&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">guisfpplt</span><span class="p">,</span> \
                        <span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;only SFP&#39;</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> \
                        <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> \
                        <span class="n">nonselection_line_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># orange</span>
<span class="n">p</span><span class="o">.</span><span class="n">patches</span><span class="p">(</span><span class="s1">&#39;x_list&#39;</span><span class="p">,</span><span class="s1">&#39;y_list&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">plot_patches</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span> <span class="c1"># white</span>

 <span class="c1"># Array and its Rays</span>
<span class="n">p</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="s1">&#39;x_c_n_unitn&#39;</span><span class="p">,</span> <span class="s1">&#39;y_c_n_unitn&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">plt_venue_slice_1</span><span class="p">,</span> \
             <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span> <span class="c1"># black</span>
<span class="n">p</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="s1">&#39;x_c_n_unitn_psi1&#39;</span><span class="p">,</span> <span class="s1">&#39;y_c_n_unitn_psi1&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">plt_venue_slice_1</span><span class="p">,</span> \
             <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span> <span class="c1"># red</span>
<span class="n">p</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="s1">&#39;x_c_n_unitn_psi2&#39;</span><span class="p">,</span> <span class="s1">&#39;y_c_n_unitn_psi2&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">plt_venue_slice_1</span><span class="p">,</span> \
             <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span> <span class="c1"># green</span>
<span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="s1">&#39;seg_pos_x&#39;</span><span class="p">,</span> <span class="s1">&#39;seg_pos_y&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">plt_venue_slice_2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span> <span class="c1"># black</span>
<span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="s1">&#39;seg_pos_start_x&#39;</span><span class="p">,</span> <span class="s1">&#39;seg_pos_start_y&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">plt_venue_slice_2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span> <span class="c1"># red</span>
<span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="s1">&#39;seg_pos_stop_x&#39;</span><span class="p">,</span> <span class="s1">&#39;seg_pos_stop_y&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">plt_venue_slice_2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span> <span class="c1"># green</span>
<span class="c1"># TapTool Callback for user interaction and Legend</span>
<span class="n">guilineplt</span><span class="o">.</span><span class="n">selected</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s1">&#39;indices&#39;</span><span class="p">,</span> <span class="n">audience_line_tap</span><span class="p">)</span>
<span class="c1"># Set legend attributes</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">orientation</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">margin</span> <span class="o">=</span> <span class="s1">&#39;top_center&#39;</span><span class="p">,</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">background_fill_alpha</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">spacing</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="kc">False</span>
<span class="c1"># export stuff for poster</span>
<span class="c1">#p.background_fill_color, p.border_fill_color = None, None</span>
<span class="c1">#p.output_backend = &quot;svg&quot;</span>

<span class="c1"># p.ygrid.minor_grid_line_alpha, p.xgrid.minor_grid_line_alpha = 0,0</span>

<span class="c1">###### Directivity (PAGE 2) ######</span>
<span class="n">pdirtools</span> <span class="o">=</span> <span class="s2">&quot;box_zoom,pan,wheel_zoom,reset,hover,save&quot;</span>
<span class="n">pdirtips</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Index&quot;</span><span class="p">,</span><span class="s2">&quot;$index&quot;</span><span class="p">),(</span><span class="s2">&quot;Amplitude in dB&quot;</span><span class="p">,</span><span class="s2">&quot;$y&quot;</span><span class="p">),(</span><span class="s2">&quot;Angle in deg&quot;</span><span class="p">,</span><span class="s2">&quot;$x&quot;</span><span class="p">)]</span>
<span class="n">pdir</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Loudspeaker Directivity for Selected Frequencies&quot;</span><span class="p">,</span> \
              <span class="n">toolbar_sticky</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="n">pdirtools</span><span class="p">,</span> <span class="n">tooltips</span><span class="o">=</span><span class="n">pdirtips</span><span class="p">,</span> \
              <span class="n">x_axis_label</span><span class="o">=</span><span class="s2">&quot;Angle in deg&quot;</span><span class="p">,</span> <span class="n">y_axis_label</span><span class="o">=</span><span class="s2">&quot;Amplitude in dB&quot;</span><span class="p">,</span> \
              <span class="n">x_range</span><span class="o">=</span><span class="n">Range1d</span><span class="p">(</span><span class="o">-</span><span class="mi">92</span><span class="p">,</span><span class="mi">92</span><span class="p">),</span> <span class="n">height</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">690</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Directivity Plot of 100 Hz, 1 kHz and 10 kHz to check used directivity in</span>
<span class="sd">   SFP and / or uploaded measured loudspeaker data.&quot;&quot;&quot;</span>
<span class="n">pdir</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">pdir</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;degree&#39;</span><span class="p">,</span> <span class="s1">&#39;amplitude_100&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">directivity_dict_plt</span><span class="p">,</span> \
          <span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;100 Hz&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;deepskyblue&#39;</span><span class="p">)</span> <span class="c1"># black</span>
<span class="n">pdir</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;degree&#39;</span><span class="p">,</span> <span class="s1">&#39;amplitude_1k&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">directivity_dict_plt</span><span class="p">,</span> \
          <span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;1 kHz&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">)</span> <span class="c1"># red</span>
<span class="n">pdir</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;degree&#39;</span><span class="p">,</span> <span class="s1">&#39;amplitude_10k&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">directivity_dict_plt</span><span class="p">,</span> \
          <span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;10 kHz&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span> <span class="c1">#orange</span>
<span class="n">pdir</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Frequencies&quot;</span>
<span class="n">pdir</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="s2">&quot;bottom_right&quot;</span>
<span class="n">pdir</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">background_fill_alpha</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">pdir</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">ticker</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>

<span class="c1">###### SPL over distance: pSPLoverX (PAGE 4) ######</span>
<span class="n">pSPLoverXtips</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;$name&quot;</span><span class="p">),(</span><span class="s2">&quot;Index&quot;</span><span class="p">,</span><span class="s2">&quot;$index&quot;</span><span class="p">),(</span><span class="s2">&quot;SPL in dB&quot;</span><span class="p">,</span> <span class="s2">&quot;$y&quot;</span><span class="p">),</span> \
                 <span class="p">(</span><span class="s2">&quot;Distance&quot;</span><span class="p">,</span> <span class="s2">&quot;$x&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;(x,y) of Venue Slice in m&quot;</span><span class="p">,</span> <span class="s2">&quot;@x_v, @y_v&quot;</span><span class="p">)]</span>
<span class="n">pSPLoverXtools</span> <span class="o">=</span> <span class="s2">&quot;box_zoom,pan,wheel_zoom,reset,hover,save, tap&quot;</span>
<span class="n">pSPLoverX</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;SPL over Distance (maximum SPL normalized to 0 dB)&quot;</span><span class="p">,</span> \
                   <span class="n">x_axis_label</span><span class="o">=</span><span class="s2">&quot;Distance LSA to Receiver in m&quot;</span><span class="p">,</span> \
                   <span class="n">y_axis_label</span><span class="o">=</span><span class="s2">&quot;SPL change in dB&quot;</span><span class="p">,</span> <span class="n">toolbar_sticky</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> \
                   <span class="n">tools</span><span class="o">=</span><span class="n">pSPLoverXtools</span><span class="p">,</span><span class="n">tooltips</span><span class="o">=</span><span class="n">pSPLoverXtips</span><span class="p">,</span> \
                   <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">height</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">690</span><span class="p">)</span> <span class="c1">#SPL over Distance (maximum SPL normalized to 0 dB), width=690</span>
<span class="sd">&quot;&quot;&quot;Sound Pressure over Distance Plot. If Target Slope weighting is chosen, the</span>
<span class="sd">   target slope can be adjusted within this figure.&quot;&quot;&quot;</span>
<span class="n">pSPLoverX</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">pSPLoverX</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;SPL&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SPLoverX_dict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightskyblue&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;PALC&quot;</span><span class="p">,</span> \
               <span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;PALC (optimized)&#39;</span><span class="p">)</span> <span class="c1">#lightskyblue</span>
<span class="c1"># pSPLoverX.circle(&#39;x&#39;, &#39;SPL&#39;, source=SPLoverX_dict, line_color=&quot;white&quot;, \</span>
<span class="c1">#                  fill_color=&quot;black&quot;, line_width=2, name=&quot;PALC&quot;, \</span>
<span class="c1">#                  legend_label=&#39;PALC (optimized)&#39;)</span>
<span class="n">pSPLoverX</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;SPL&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SPLoverX_ref_dict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Reference&quot;</span><span class="p">,</span> \
               <span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;Reference LSA&#39;</span><span class="p">)</span> <span class="c1">#orange</span>
<span class="n">Opt2</span> <span class="o">=</span> <span class="n">pSPLoverX</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;SPL&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">Opt_SPLoverX_dict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lime&quot;</span><span class="p">,</span> \
                      <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Reference&quot;</span><span class="p">,</span> <span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;Target Slope&#39;</span><span class="p">)</span> <span class="c1">#lime</span>
<span class="n">Opt1</span> <span class="o">=</span> <span class="n">pSPLoverX</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;SPL&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">Opt_SPLoverX_dict</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span> \
                        <span class="n">fill_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Reference&quot;</span><span class="p">,</span> \
                        <span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;Target Slope&#39;</span><span class="p">)</span>
<span class="n">Opt_ref</span> <span class="o">=</span> <span class="n">pSPLoverX</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="s1">&#39;x_ref&#39;</span><span class="p">,</span><span class="s1">&#39;SPL&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">Opt_refpoint_dict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkred&quot;</span><span class="p">,</span> \
                           <span class="n">fill_color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Reference Point&quot;</span><span class="p">,</span> \
                           <span class="n">legend_label</span><span class="o">=</span><span class="s2">&quot;Reference Point&quot;</span><span class="p">)</span>
<span class="n">pSPLoverX</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">SPLoverX_optreg</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">pSPLoverX</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="n">pSPLoverX</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="s1">&#39;top_right&#39;</span><span class="p">,</span> <span class="s1">&#39;horizontal&#39;</span>
<span class="n">pSPLoverX</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">margin</span><span class="p">,</span> <span class="n">pSPLoverX</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">glyph_width</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span>
<span class="n">pSPLoverX</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">background_fill_alpha</span><span class="p">,</span> <span class="n">pSPLoverX</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">spacing</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">15</span>

<span class="n">Opt_SPLoverX_dict</span><span class="o">.</span><span class="n">selected</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s1">&#39;indices&#39;</span><span class="p">,</span> <span class="n">optimal_SPLoverX</span><span class="p">)</span>
<span class="n">Opt_refpoint_dict</span><span class="o">.</span><span class="n">selected</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s1">&#39;indices&#39;</span><span class="p">,</span> <span class="n">optimal_SPLoverX</span><span class="p">)</span>
<span class="n">optSPLtool</span> <span class="o">=</span> <span class="n">PointDrawTool</span><span class="p">(</span><span class="n">renderers</span><span class="o">=</span><span class="p">[</span><span class="n">Opt1</span><span class="p">,</span> <span class="n">Opt2</span><span class="p">,</span> <span class="n">Opt_ref</span><span class="p">],</span> <span class="n">add</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pSPLoverX</span><span class="o">.</span><span class="n">add_tools</span><span class="p">(</span><span class="n">optSPLtool</span><span class="p">)</span>
<span class="n">pSPLoverX</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">active_tap</span> <span class="o">=</span> <span class="n">optSPLtool</span>

<span class="c1"># export stuff for poster</span>
<span class="n">pSPLoverX</span><span class="o">.</span><span class="n">background_fill_color</span><span class="p">,</span> <span class="n">pSPLoverX</span><span class="o">.</span><span class="n">border_fill_color</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<span class="n">pSPLoverX</span><span class="o">.</span><span class="n">output_backend</span> <span class="o">=</span> <span class="s2">&quot;svg&quot;</span>

<span class="c1">####### Venue Slice with Colorbar and TapTool: pSFPv (PAGE 5) ######</span>
<span class="n">pSFPvtooltips</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Index&quot;</span><span class="p">,</span> <span class="s2">&quot;$index&quot;</span><span class="p">),(</span><span class="s2">&quot;(x,y)&quot;</span><span class="p">,</span> <span class="s2">&quot;(@x_vert, @y_vert)&quot;</span><span class="p">),]</span>
<span class="n">pSFPvtools</span> <span class="o">=</span> <span class="s2">&quot;box_zoom,pan,wheel_zoom,reset,tap,hover,save&quot;</span>
<span class="n">pSFPv</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;28. Venue Slice Positions&quot;</span><span class="p">,</span> <span class="n">x_axis_label</span><span class="o">=</span><span class="s2">&quot;x in m&quot;</span><span class="p">,</span> \
               <span class="n">y_axis_label</span><span class="o">=</span><span class="s2">&quot;y in m&quot;</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="n">pSFPvtools</span><span class="p">,</span> <span class="n">tooltips</span><span class="o">=</span><span class="n">pSFPvtooltips</span><span class="p">,</span> \
               <span class="n">width</span><span class="o">=</span><span class="mi">1220</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Venue Slice Plot of SFP, shows the discrete points of the venue slice in</span>
<span class="sd">   color of the frequency responses in :any:`pSFP`.&quot;&quot;&quot;</span>
<span class="n">pSFPv</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">pSFPv</span><span class="o">.</span><span class="n">patches</span><span class="p">(</span><span class="s1">&#39;x_list&#39;</span><span class="p">,</span><span class="s1">&#39;y_list&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">plot_patches</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span> <span class="c1">#black</span>
<span class="c1"># TapTool for user interaction</span>
<span class="n">SFPv_dict</span><span class="o">.</span><span class="n">selected</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="s1">&#39;indices&#39;</span><span class="p">,</span> <span class="n">tap_handle</span><span class="p">)</span>

<span class="c1">###### Sound Field Prediction PALC: pSFP (PAGE 5) ######</span>
<span class="n">pSFPtools</span> <span class="o">=</span> <span class="s2">&quot;box_zoom,pan,wheel_zoom,reset,tap,hover,save&quot;</span>
<span class="n">pSFPtooltips</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Index&quot;</span><span class="p">,</span> <span class="s2">&quot;$index&quot;</span><span class="p">),(</span><span class="s2">&quot;Frequency in Hz&quot;</span><span class="p">,</span> <span class="s2">&quot;$x&quot;</span><span class="p">),(</span><span class="s2">&quot;SPL in dB&quot;</span><span class="p">,</span> <span class="s2">&quot;$y&quot;</span><span class="p">)]</span>
<span class="n">pSFP</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;29. SPL at all Audience Positions: PALC&quot;</span><span class="p">,</span> \
              <span class="n">x_axis_type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">24000</span><span class="p">),</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> \
              <span class="n">x_axis_label</span><span class="o">=</span><span class="s2">&quot;f in kHz&quot;</span><span class="p">,</span> <span class="n">y_axis_label</span><span class="o">=</span><span class="s2">&quot;SPL in dB&quot;</span><span class="p">,</span> \
              <span class="n">tools</span><span class="o">=</span><span class="n">pSFPtools</span><span class="p">,</span> <span class="n">toolbar_sticky</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> \
              <span class="n">tooltips</span><span class="o">=</span><span class="n">pSFPtooltips</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">610</span><span class="p">)</span> <span class="c1">#29. SPL at all Audience Positions: PALC</span>
<span class="sd">&quot;&quot;&quot;Frequency Response Plot of PALC results of each discrete point on venue</span>
<span class="sd">   slice. Color of the responses belongs to the discrete points in figure</span>
<span class="sd">   :any:`pSFPv`.&quot;&quot;&quot;</span>
<span class="n">pSFP</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">pSFP</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">ticker</span> <span class="o">=</span> <span class="n">f_ticks</span>
<span class="n">pSFP</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">major_label_overrides</span> <span class="o">=</span> <span class="n">f_ticks_override</span>

<span class="c1"># export stuff for poster</span>
<span class="c1">#pSFP.background_fill_color, pSFP.border_fill_color = None, None</span>
<span class="c1">#pSFP.output_backend = &quot;svg&quot;</span>

<span class="c1">###### Sound Field Prediction straight array: pSFPref (PAGE 5) ######</span>
<span class="n">pSFPreftools</span> <span class="o">=</span> <span class="s2">&quot;box_zoom,pan,wheel_zoom,reset,tap,hover,save&quot;</span>
<span class="n">pSFPreftooltips</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Index&quot;</span><span class="p">,</span> <span class="s2">&quot;$index&quot;</span><span class="p">),(</span><span class="s2">&quot;Frequency in Hz&quot;</span><span class="p">,</span> <span class="s2">&quot;$x&quot;</span><span class="p">),(</span><span class="s2">&quot;SPL in dB&quot;</span><span class="p">,</span> <span class="s2">&quot;$y&quot;</span><span class="p">)]</span>
<span class="n">pSFPref</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;30. SPL at all Audience Positions: Reference Array&quot;</span><span class="p">,</span> \
                 <span class="n">x_axis_type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span><span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">24000</span><span class="p">),</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> \
                 <span class="n">x_axis_label</span><span class="o">=</span><span class="s2">&quot;f in kHz&quot;</span><span class="p">,</span> <span class="n">y_axis_label</span><span class="o">=</span><span class="s2">&quot;SPL in dB&quot;</span><span class="p">,</span> \
                 <span class="n">tools</span><span class="o">=</span><span class="n">pSFPreftools</span><span class="p">,</span> <span class="n">toolbar_sticky</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> \
                 <span class="n">tooltips</span><span class="o">=</span><span class="n">pSFPreftooltips</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">610</span><span class="p">)</span> <span class="c1">#30. SPL at all Audience Positions: Reference Array&quot;</span>
<span class="n">pSFPref</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">pSFPref</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">ticker</span> <span class="o">=</span> <span class="n">f_ticks</span>
<span class="n">pSFPref</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">major_label_overrides</span> <span class="o">=</span> <span class="n">f_ticks_override</span>

<span class="c1"># export stuff for poster</span>
<span class="c1">#pSFPref.background_fill_color, pSFPref.border_fill_color = None, None</span>
<span class="c1">#pSFPref.output_backend = &quot;svg&quot;</span>

<span class="c1">###### Homogeneity PALC and reference array: pHom (PAGE 5) ######</span>
<span class="n">pHomtools</span> <span class="o">=</span> <span class="s2">&quot;box_zoom,pan,wheel_zoom,reset,hover,save&quot;</span>
<span class="n">pHomtooltips</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Frequency in Hz&quot;</span><span class="p">,</span> <span class="s2">&quot;$x&quot;</span><span class="p">),(</span><span class="s2">&quot;SPL in dB&quot;</span><span class="p">,</span> <span class="s2">&quot;$y&quot;</span><span class="p">)]</span>
<span class="n">pHom</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;31. Homogeneity&quot;</span><span class="p">,</span> <span class="n">x_axis_type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> \
              <span class="n">x_axis_label</span><span class="o">=</span><span class="s2">&quot;f in kHz&quot;</span><span class="p">,</span> <span class="n">y_axis_label</span><span class="o">=</span><span class="s2">&quot;H(f) in dB&quot;</span><span class="p">,</span> \
              <span class="n">tools</span><span class="o">=</span><span class="n">pHomtools</span><span class="p">,</span> <span class="n">tooltips</span><span class="o">=</span><span class="n">pHomtooltips</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">24000</span><span class="p">),</span> \
              <span class="n">width</span><span class="o">=</span><span class="mi">1220</span><span class="p">)</span> <span class="c1">#31. Homogeneity</span>
<span class="sd">&quot;&quot;&quot;Frequency Response Plot of reference array of each discrete point on venue</span>
<span class="sd">   slice. Color of the responses belongs to the discrete points in figure</span>
<span class="sd">   :any:`pSFPv`.&quot;&quot;&quot;</span>
<span class="n">pHom</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">pHom</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">ticker</span> <span class="o">=</span> <span class="n">f_ticks</span>
<span class="n">pHom</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">major_label_overrides</span> <span class="o">=</span> <span class="n">f_ticks_override</span>
<span class="n">pHom</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">Homogeneity_dict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightskyblue&quot;</span><span class="p">,</span> \
          <span class="n">legend_label</span><span class="o">=</span><span class="s2">&quot;PALC&quot;</span><span class="p">)</span> <span class="c1"># lightskyblue</span>
<span class="n">pHom</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;H_dist_high&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">Homogeneity_dict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;navajowhite&quot;</span><span class="p">,</span> \
          <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span> <span class="c1">#navajowhite</span>
<span class="n">pHom</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;H_dist_low&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">Homogeneity_dict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;navajowhite&quot;</span><span class="p">,</span> \
          <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span> <span class="c1"># navajowhite</span>
<span class="n">pHom</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;H_str&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">Homogeneity_dict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> \
          <span class="n">legend_label</span><span class="o">=</span><span class="s2">&quot;Reference Array&quot;</span><span class="p">)</span> <span class="c1">#orange</span>
<span class="n">pHom</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="s2">&quot;top_left&quot;</span>

<span class="c1"># export stuff for poster</span>
<span class="c1">#pHom.background_fill_color, pHom.border_fill_color = None, None</span>
<span class="c1">#pHom.output_backend = &quot;svg&quot;</span>

<span class="c1">###### Beamplot PALC: pBeam (PAGE 5) ######</span>
<span class="n">pBeamtips</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;SPL in dB&quot;</span><span class="p">,</span> <span class="s2">&quot;@SPL&quot;</span><span class="p">),(</span><span class="s2">&quot;(x in m, y in m)&quot;</span><span class="p">,</span> <span class="s2">&quot;($x, $y)&quot;</span><span class="p">),]</span>
<span class="n">pBeamtools</span> <span class="o">=</span> <span class="s2">&quot;box_zoom,pan,wheel_zoom,reset,hover,save&quot;</span>
<span class="n">pBeam</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;34. Beam Plot PALC: SPL in dB&quot;</span><span class="p">,</span> <span class="n">x_axis_label</span><span class="o">=</span><span class="s2">&quot;x in m&quot;</span><span class="p">,</span> \
               <span class="n">y_axis_label</span><span class="o">=</span><span class="s2">&quot;y in m&quot;</span><span class="p">,</span> <span class="n">frame_width</span><span class="o">=</span><span class="mi">1110</span><span class="p">,</span> <span class="n">match_aspect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> \
               <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="n">pBeamtools</span><span class="p">,</span> <span class="n">tooltips</span><span class="o">=</span><span class="n">pBeamtips</span><span class="p">)</span> <span class="c1">#34. Beam Plot PALC: SPL in dB</span>
<span class="sd">&quot;&quot;&quot;Beamplot of PALC results&quot;&quot;&quot;</span>
<span class="n">pBeam</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">pBeam</span><span class="o">.</span><span class="n">x_range</span><span class="o">.</span><span class="n">range_padding</span> <span class="o">=</span> <span class="n">pBeam</span><span class="o">.</span><span class="n">y_range</span><span class="o">.</span><span class="n">range_padding</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">mapper</span> <span class="o">=</span> <span class="n">LinearColorMapper</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="n">Cividis256</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">color_bar</span> <span class="o">=</span> <span class="n">ColorBar</span><span class="p">(</span><span class="n">color_mapper</span><span class="o">=</span><span class="n">mapper</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> \
                     <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">title_text_font_style</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>
<span class="n">pBeam</span><span class="o">.</span><span class="n">add_layout</span><span class="p">(</span><span class="n">color_bar</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">pBeam</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="s1">&#39;SPL&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">dw</span><span class="o">=</span><span class="s1">&#39;dw&#39;</span><span class="p">,</span> <span class="n">dh</span><span class="o">=</span><span class="s1">&#39;dh&#39;</span><span class="p">,</span> \
            <span class="n">source</span><span class="o">=</span><span class="n">Beamplot_dict</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">Cividis256</span><span class="p">)</span>
<span class="n">pBeam</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="s1">&#39;xlineplt&#39;</span><span class="p">,</span> <span class="s1">&#39;ylineplt&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">guilineplt</span><span class="p">,</span> \
                 <span class="n">line_dash</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                 <span class="n">selection_color</span><span class="o">=</span><span class="s2">&quot;darkred&quot;</span><span class="p">)</span>
<span class="n">pBeam</span><span class="o">.</span><span class="n">patches</span><span class="p">(</span><span class="s1">&#39;x_list&#39;</span><span class="p">,</span><span class="s1">&#39;y_list&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">plot_patches</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

<span class="n">pBeamreftips</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;SPL in dB&quot;</span><span class="p">,</span> <span class="s2">&quot;@SPL_ref&quot;</span><span class="p">),(</span><span class="s2">&quot;(x in m, y in m)&quot;</span><span class="p">,</span> <span class="s2">&quot;($x, $y)&quot;</span><span class="p">),]</span>
<span class="n">pBeamreftools</span> <span class="o">=</span> <span class="s2">&quot;box_zoom,pan,wheel_zoom,reset,hover,save&quot;</span>
<span class="n">pBeam_ref</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;34. Beam Plot Reference: SPL in dB&quot;</span><span class="p">,</span> \
                   <span class="n">x_axis_label</span><span class="o">=</span><span class="s2">&quot;x in m&quot;</span><span class="p">,</span> <span class="n">y_axis_label</span><span class="o">=</span><span class="s2">&quot;y in m&quot;</span><span class="p">,</span> \
                   <span class="n">frame_width</span><span class="o">=</span><span class="mi">1110</span><span class="p">,</span> <span class="n">match_aspect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> \
                   <span class="n">tools</span><span class="o">=</span><span class="n">pBeamreftools</span><span class="p">,</span> <span class="n">tooltips</span><span class="o">=</span><span class="n">pBeamreftips</span><span class="p">)</span> <span class="c1">#34. Beam Plot Reference: SPL in dB</span>
<span class="sd">&quot;&quot;&quot;Beamplot of reference array&quot;&quot;&quot;</span>
<span class="n">pBeam_ref</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">pBeam_ref</span><span class="o">.</span><span class="n">x_range</span><span class="o">.</span><span class="n">range_padding</span> <span class="o">=</span> <span class="n">pBeam</span><span class="o">.</span><span class="n">y_range</span><span class="o">.</span><span class="n">range_padding</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">mapper_ref</span> <span class="o">=</span> <span class="n">LinearColorMapper</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="n">Cividis256</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">color_bar_ref</span> <span class="o">=</span> <span class="n">ColorBar</span><span class="p">(</span><span class="n">color_mapper</span><span class="o">=</span><span class="n">mapper_ref</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> \
                     <span class="n">title_standoff</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">title_text_font_style</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>
<span class="n">pBeam_ref</span><span class="o">.</span><span class="n">add_layout</span><span class="p">(</span><span class="n">color_bar_ref</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">pBeam_ref</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="s1">&#39;SPL_ref&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">dw</span><span class="o">=</span><span class="s1">&#39;dw&#39;</span><span class="p">,</span> <span class="n">dh</span><span class="o">=</span><span class="s1">&#39;dh&#39;</span><span class="p">,</span> \
                <span class="n">source</span><span class="o">=</span><span class="n">Beamplot_dict</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">Cividis256</span><span class="p">)</span>
<span class="n">pBeam_ref</span><span class="o">.</span><span class="n">multi_line</span><span class="p">(</span><span class="s1">&#39;xlineplt&#39;</span><span class="p">,</span> <span class="s1">&#39;ylineplt&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">guilineplt</span><span class="p">,</span> \
                     <span class="n">line_dash</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                     <span class="n">selection_color</span><span class="o">=</span><span class="s2">&quot;darkred&quot;</span><span class="p">)</span>
<span class="n">pBeam_ref</span><span class="o">.</span><span class="n">patches</span><span class="p">(</span><span class="s1">&#39;x_list_ref&#39;</span><span class="p">,</span><span class="s1">&#39;y_list_ref&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">plot_patches</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">pBeam</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label_text_font_style</span> <span class="o">=</span> <span class="s2">&quot;normal&quot;</span>

<span class="c1">###### Bar Plots: pBar, pBarref (PAGE 5) ######</span>
<span class="c1"># Bar Chart PALC: pBar</span>
<span class="n">pBar</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;32. Bar Chart: PALC&quot;</span><span class="p">,</span> <span class="n">x_axis_label</span><span class="o">=</span><span class="s2">&quot;SPL in dB&quot;</span><span class="p">,</span> \
              <span class="n">y_axis_label</span><span class="o">=</span><span class="s2">&quot;Number of Positions&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">610</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Barplot of PALC results. Number of Positions that contain SPL values on</span>
<span class="sd">   y-axis.&quot;&quot;&quot;</span>
<span class="n">pBar</span><span class="o">.</span><span class="n">vbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">Bar_dict</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;firebrick&quot;</span><span class="p">)</span>
<span class="n">pBar</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1"># Bar Chart straight array: pBarsref</span>
<span class="n">pBarref</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;33. Bar Chart: Reference Array&quot;</span><span class="p">,</span> <span class="n">x_axis_label</span><span class="o">=</span><span class="s2">&quot;SPL in dB&quot;</span><span class="p">,</span> \
                 <span class="n">y_axis_label</span><span class="o">=</span><span class="s2">&quot;Number of positions&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">610</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Barplot of reference array. Number of Positions that contain SPL values on</span>
<span class="sd">   y-axis.&quot;&quot;&quot;</span>
<span class="n">pBarref</span><span class="o">.</span><span class="n">vbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;x_ref&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="s1">&#39;top_ref&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">Bar_dict_ref</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> \
             <span class="n">width</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;firebrick&quot;</span><span class="p">)</span>
<span class="n">pBarref</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1">###### Tab-Plots: Venue Slice - Directivity (PAGE 2) and Venue Slice - SPLoverX (PAGE 4) ######</span>
<span class="c1"># Venue Slice Plot and LS Directivity (PAGE 2)</span>
<span class="n">dir_tab1</span> <span class="o">=</span> <span class="n">Panel</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Venue Slice&quot;</span><span class="p">)</span>
<span class="n">dir_tab2</span> <span class="o">=</span> <span class="n">Panel</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="n">pdir</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Loudspeaker Directivity&quot;</span><span class="p">)</span>
<span class="n">dir_tabs</span> <span class="o">=</span> <span class="n">Tabs</span><span class="p">(</span><span class="n">tabs</span><span class="o">=</span><span class="p">[</span><span class="n">dir_tab1</span><span class="p">,</span> <span class="n">dir_tab2</span><span class="p">])</span>
<span class="c1"># Venue Slice Plot and SPL over distance (PAGE 4)</span>
<span class="n">SPLoverX_tab1</span> <span class="o">=</span> <span class="n">Panel</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Venue Slice&quot;</span><span class="p">)</span>
<span class="n">SPLoverX_tab2</span> <span class="o">=</span> <span class="n">Panel</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="n">column</span><span class="p">([</span><span class="n">gui_freq_range</span><span class="p">,</span> <span class="n">pSPLoverX</span><span class="p">]),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;SPL over Distance&quot;</span><span class="p">)</span>
<span class="n">SPLoverX_tabs</span> <span class="o">=</span> <span class="n">Tabs</span><span class="p">(</span><span class="n">tabs</span><span class="o">=</span><span class="p">[</span><span class="n">SPLoverX_tab1</span><span class="p">,</span> <span class="n">SPLoverX_tab2</span><span class="p">])</span>
<span class="c1"># Result Tabs (PAGE 5)</span>
<span class="n">res_tab1</span> <span class="o">=</span> <span class="n">Panel</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="n">column</span><span class="p">([</span><span class="n">pSFPv</span><span class="p">,</span> <span class="n">row</span><span class="p">([</span><span class="n">pSFP</span><span class="p">,</span> <span class="n">pSFPref</span><span class="p">])]),</span> \
                 <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Frequency Responses at Audience Positions&quot;</span><span class="p">)</span>
<span class="n">res_tab2</span> <span class="o">=</span> <span class="n">Panel</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="n">pHom</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Homogeneity&quot;</span><span class="p">)</span>
<span class="n">res_tab3</span> <span class="o">=</span> <span class="n">Panel</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="n">row</span><span class="p">([</span><span class="n">pBar</span><span class="p">,</span> <span class="n">pBarref</span><span class="p">]),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Bar Chart&quot;</span><span class="p">)</span>
<span class="n">res_tab4</span> <span class="o">=</span> <span class="n">Panel</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="n">column</span><span class="p">([</span><span class="n">row</span><span class="p">([</span><span class="n">gui_f_beam</span><span class="p">,</span> <span class="n">column</span><span class="p">([</span><span class="n">p_which_beamplot</span><span class="p">,</span> <span class="n">gui_which_beam</span><span class="p">])]),</span> \
                               <span class="n">pBeam</span><span class="p">,</span> <span class="n">pBeam_ref</span><span class="p">]),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Beam Plots&quot;</span><span class="p">)</span>
<span class="n">res_tabs</span> <span class="o">=</span> <span class="n">Tabs</span><span class="p">(</span><span class="n">tabs</span><span class="o">=</span><span class="p">[</span><span class="n">res_tab1</span><span class="p">,</span> <span class="n">res_tab2</span><span class="p">,</span> <span class="n">res_tab3</span><span class="p">,</span> <span class="n">res_tab4</span><span class="p">])</span>

<span class="c1">###### Set up values before showing on Data Table</span>
<span class="n">PALC_config</span><span class="o">.</span><span class="n">store_config</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">gui_N_LS</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="c1">###### DATA TABLE of Resulting PALC Calculcation (PAGE 4) ###### </span>
<span class="n">results_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">TableColumn</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s2">&quot;a_num_LS&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;LS&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span> 
                   <span class="n">TableColumn</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s2">&quot;b_gamma_tilt_deg&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Total Angle&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">80</span><span class="p">),</span>  
                   <span class="n">TableColumn</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s2">&quot;c_gamma_tilt_deg_diff&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ICA&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">80</span><span class="p">)]</span> 
<span class="n">results_table</span> <span class="o">=</span> <span class="n">DataTable</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">results_dict</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">results_columns</span><span class="p">,</span> \
                          <span class="n">index_position</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span> \
                          <span class="n">fit_columns</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1">###### DATA TABLE of Reference Array</span>
<span class="n">ref_arr_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">TableColumn</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s2">&quot;LS&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;LS&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span> \
                   <span class="n">TableColumn</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s2">&quot;gamma_ref&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Tilt Angle in deg&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)]</span>
<span class="n">ref_arr_table</span>   <span class="o">=</span> <span class="n">DataTable</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">gamma_ref_dict</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">ref_arr_columns</span><span class="p">,</span> \
                            <span class="n">index_position</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">170</span><span class="p">,</span> <span class="n">fit_columns</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1">#%%######### set up the bokeh document in browser for the first run ###########</span>
<span class="n">col0</span> <span class="o">=</span> <span class="n">column</span><span class="p">([</span><span class="n">xAchse</span><span class="p">,</span> <span class="n">start_point_x</span><span class="p">,</span> <span class="n">end_point_x</span><span class="p">,</span> <span class="n">strich1</span><span class="p">,</span> <span class="n">line_discretization</span><span class="p">,</span> <span class="n">pal_error_info</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
<span class="n">col1</span> <span class="o">=</span> <span class="n">column</span><span class="p">([</span><span class="n">yAchse</span><span class="p">,</span> <span class="n">start_point_y</span><span class="p">,</span> <span class="n">end_point_y</span><span class="p">,</span> <span class="n">strich6</span><span class="p">,</span> <span class="n">save_line_button</span><span class="p">,</span> <span class="n">remove_line_button</span><span class="p">,</span> \
               <span class="n">save_prev_line_button</span><span class="p">,</span> <span class="n">remove_sel_line_button</span><span class="p">,</span> <span class="n">check_PAL_button</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
<span class="n">col2</span> <span class="o">=</span> <span class="n">column</span><span class="p">([</span><span class="n">row</span><span class="p">([</span><span class="n">p_equal_axis_dist</span><span class="p">,</span> <span class="n">p_equal_axis</span><span class="p">]),</span> <span class="n">p</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">690</span><span class="p">)</span>
<span class="n">row0</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">column</span><span class="p">(</span><span class="n">aklogo</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="n">tublogo</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">170</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="n">aklogo2</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">270</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="n">gui_step</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">690</span><span class="p">)])</span>
<span class="n">row1</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">headline</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">1230</span><span class="p">)</span>
<span class="n">row2</span> <span class="o">=</span> <span class="n">row</span><span class="p">([</span><span class="n">col0</span><span class="p">,</span> <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">])</span>
<span class="n">figall</span> <span class="o">=</span> <span class="n">gridplot</span><span class="p">([[</span><span class="n">row0</span><span class="p">],[</span><span class="n">row1</span><span class="p">],[</span><span class="n">row2</span><span class="p">]],</span> <span class="n">toolbar_location</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">merge_tools</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">curdoc</span><span class="p">()</span><span class="o">.</span><span class="n">add_root</span><span class="p">(</span><span class="n">figall</span><span class="p">)</span>

<span class="c1">########################## END MAIN ##########################################</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pyPALC  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">main</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Arne Hoelter.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.1.
    </div>
  </body>
</html>